#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ResilientDB: 06_exception_hierarchy</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d0/d89/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Requests_206__exception__hierarchy.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">06_exception_hierarchy</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md2965"></a>
autotoc_md2965</h2>
<p>layout: default title: "Exception Hierarchy" parent: "Requests" </p>
<h2><a class="anchor" id="autotoc_md2966"></a>
nav_order: 6</h2>
<h1><a class="anchor" id="autotoc_md2967"></a>
Chapter 6: When Things Go Wrong - The Exception Hierarchy</h1>
<p>In <a class="el" href="../../d7/df0/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Requests_205__authentication__handlers.html">Chapter 5: Authentication Handlers</a>, we learned how to prove our identity to websites that require login or API keys. We assumed our requests would work if we provided the correct credentials.</p>
<p>But what happens when things <em>don't</em> go as planned? The internet isn't always reliable. Websites go down, networks have hiccups, URLs might be typed incorrectly, or servers might just be having a bad day. How does <code>requests</code> tell us about these problems, and how can we handle them gracefully in our code?</p>
<h2><a class="anchor" id="autotoc_md2968"></a>
The Problem: Dealing with Request Failures</h2>
<p>Imagine you're building a script to check the weather using an online weather API. You use <code>requests.get()</code> to fetch the weather data. What could go wrong?</p>
<ul>
<li>Your internet connection might be down.</li>
<li>The weather API website might be temporarily offline.</li>
<li>You might have mistyped the URL.</li>
<li>The website might take too long to respond (a timeout).</li>
<li>The website might respond, but with an error message (like "404 Not Found" or "500 Server Error").</li>
</ul>
<p>If any of these happen, <code>requests</code> will encounter an error. If you don't prepare for these errors, your script might crash! We need a way to:</p>
<ol type="1">
<li><b>Detect</b> that an error occurred.</li>
<li><b>Understand</b> <em>what kind</em> of error it was (network issue? timeout? bad URL?).</li>
<li><b>React</b> appropriately (e.g., print a helpful message, try again later, use a default value).</li>
</ol>
<h2><a class="anchor" id="autotoc_md2969"></a>
The Solution: A Family Tree of Errors</h2>
<p><code>Requests</code> helps us by using a system of specific error messages called <b>exceptions</b>. When something goes wrong, <code>requests</code> doesn't just give up silently; it <b>raises an exception</b>.</p>
<p>Think of it like a doctor diagnosing an illness. A doctor doesn't just say "You're sick." They give a specific diagnosis: "You have the flu," or "You have a broken arm," or "You have allergies." Each diagnosis tells you something specific about the problem and how to treat it.</p>
<p><code>Requests</code> does something similar with its exceptions. It has a main, general exception called <code>requests.exceptions.RequestException</code>. All other specific <code>requests</code> errors are "children" or "descendants" of this main one, forming an <b>Exception Hierarchy</b> (like a family tree).</p>
<p><b>Analogy:</b> The "Sickness" Family Tree ðŸŒ³</p>
<ul>
<li><b><code>RequestException</code> (The Grandparent):</b> This is the most general category, like saying "Sickness." If you catch this, you catch <em>any</em> problem related to <code>requests</code>.</li>
<li><b><code>ConnectionError</code>, <code>Timeout</code>, <code>HTTPError</code>, <code>URLRequired</code> (The Parents):</b> These are more specific categories under <code>RequestException</code>.<ul>
<li><code>ConnectionError</code> is like saying "Infection."</li>
<li><code>Timeout</code> is like saying "Fatigue."</li>
<li><code>HTTPError</code> is like saying "External Injury."</li>
<li><code>URLRequired</code> is like saying "Genetic Condition" (problem with the input itself).</li>
</ul>
</li>
<li><b><code>ConnectTimeout</code>, <code>ReadTimeout</code> (The Children):</b> These are even <em>more</em> specific.<ul>
<li><code>ConnectTimeout</code> (child of <code>Timeout</code>) is like "Trouble Falling Asleep."</li>
<li><code>ReadTimeout</code> (child of <code>Timeout</code>) is like "Waking Up Too Early." Both are types of "Fatigue" (<code>Timeout</code>).</li>
</ul>
</li>
</ul>
<p>This hierarchy allows you to decide how specific you want to be when handling errors.</p>
<h2><a class="anchor" id="autotoc_md2970"></a>
Key Members of the Exception Family</h2>
<p>All <code>requests</code> exceptions live inside the <code>requests.exceptions</code> module. You usually import the main <code>requests</code> library and access them like <code>requests.exceptions.ConnectionError</code>.</p>
<p>Here are some of the most common ones you'll encounter:</p>
<ul>
<li><b><code>requests.exceptions.RequestException</code></b>: The base exception. Catching this catches <em>all</em> exceptions listed below.</li>
<li><b><code>requests.exceptions.ConnectionError</code></b>: Problems connecting to the server. This could be due to:<ul>
<li>DNS failure (can't find the server's address).</li>
<li>Refused connection (server is there but not accepting connections).</li>
<li>Network is unreachable.</li>
</ul>
</li>
<li><b><code>requests.exceptions.Timeout</code></b>: The request took too long. This is a parent category for:<ul>
<li><b><code>requests.exceptions.ConnectTimeout</code></b>: Timeout occurred <em>while trying to establish the connection</em>.</li>
<li><b><code>requests.exceptions.ReadTimeout</code></b>: Timeout occurred <em>after connecting</em>, while waiting for the server to send data.</li>
</ul>
</li>
<li><b><code>requests.exceptions.HTTPError</code></b>: Raised when the server returns a "bad" status code (4xx for client errors like "404 Not Found", or 5xx for server errors like "500 Internal Server Error"). <b>Important:</b> <code>requests</code> does <em>not</em> automatically raise this just because the status code is bad. You typically need to call the <code>response.raise_for_status()</code> method to trigger it.</li>
<li><b><code>requests.exceptions.TooManyRedirects</code></b>: The request exceeded the maximum number of allowed redirects (usually 30).</li>
<li><b><code>requests.exceptions.URLRequired</code></b>: You tried to make a request without providing a URL.</li>
<li><b><code>requests.exceptions.MissingSchema</code></b>: The URL was missing the scheme (like <code><a href="http://">http://</a></code> or <code><a href="https://">https://</a></code>).</li>
<li><b><code>requests.exceptions.InvalidURL</code></b>: The URL was malformed in some way.</li>
<li><b><code>requests.exceptions.InvalidSchema</code></b>: The URL scheme was not recognized (e.g., <code><a href="ftp://">ftp://</a></code> might not be supported by default).</li>
</ul>
<h2><a class="anchor" id="autotoc_md2971"></a>
Handling Exceptions: The <code>try...except</code> Block</h2>
<p>How do we use this hierarchy in our code? We use Python's <code>try...except</code> block.</p>
<ol type="1">
<li>Put the code that <em>might</em> cause an error (like <code>requests.get()</code>) inside the <code>try:</code> block.</li>
<li>Follow it with one or more <code>except:</code> blocks. Each <code>except:</code> block specifies the type of exception it's designed to catch.</li>
</ol>
<p><b>Example 1: Catching Any <code>requests</code> Error</b></p>
<p>Let's try fetching a URL that doesn't exist and catch the most general exception.</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> requests</div>
<div class="line"> </div>
<div class="line"><span class="comment"># A URL that might cause a connection error (e.g., non-existent domain)</span></div>
<div class="line">bad_url = <span class="stringliteral">&#39;https://this-domain-probably-does-not-exist-asdfghjkl.com&#39;</span></div>
<div class="line">good_url = <span class="stringliteral">&#39;https://httpbin.org/get&#39;</span></div>
<div class="line"> </div>
<div class="line">url_to_try = bad_url <span class="comment"># Change to good_url to see success case</span></div>
<div class="line"> </div>
<div class="line">print(f<span class="stringliteral">&quot;Trying to fetch: {url_to_try}&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">try</span>:</div>
<div class="line">    response = requests.get(url_to_try, timeout=5) <span class="comment"># Add timeout</span></div>
<div class="line">    response.raise_for_status() <span class="comment"># Check for 4xx/5xx errors</span></div>
<div class="line">    print(<span class="stringliteral">&quot;Success! Status Code:&quot;</span>, response.status_code)</div>
<div class="line">    <span class="comment"># Process the response... (e.g., print response.text)</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</div>
<div class="line">    <span class="comment"># This will catch ANY error originating from requests</span></div>
<div class="line">    print(f<span class="stringliteral">&quot;\nOh no! A requests-related error occurred:&quot;</span>)</div>
<div class="line">    print(f<span class="stringliteral">&quot;Error Type: {type(e).__name__}&quot;</span>)</div>
<div class="line">    print(f<span class="stringliteral">&quot;Error Details: {e}&quot;</span>)</div>
<div class="line"> </div>
<div class="line">print(<span class="stringliteral">&quot;\nScript continues after handling the error.&quot;</span>)</div>
</div><!-- fragment --><p><b>Possible Output (if <code>url_to_try = bad_url</code>):</b></p>
<div class="fragment"><div class="line">Trying to fetch: https://this-domain-probably-does-not-exist-asdfghjkl.com</div>
<div class="line"> </div>
<div class="line">Oh no! A requests-related error occurred:</div>
<div class="line">Error Type: ConnectionError</div>
<div class="line">Error Details: HTTPSConnectionPool(host=&#39;this-domain-probably-does-not-exist-asdfghjkl.com&#39;, port=443): Max retries exceeded with url: / (Caused by NameResolutionError(&quot;&lt;urllib3.connection.HTTPSConnection object at 0x...&gt;: Failed to resolve &#39;this-domain-probably-does-not-exist-asdfghjkl.com&#39; ([Errno ...)&quot;))</div>
<div class="line"> </div>
<div class="line">Script continues after handling the error.</div>
</div><!-- fragment --><p><b>Explanation:</b></p>
<ul>
<li>We put <code>requests.get()</code> and <code>response.raise_for_status()</code> inside the <code>try</code> block.</li>
<li>If <code>requests.get()</code> fails (e.g., due to <code>ConnectionError</code> or <code>Timeout</code>), or if <code>raise_for_status()</code> detects a 4xx/5xx code (<code>HTTPError</code>), an exception is raised.</li>
<li>The <code>except requests.exceptions.RequestException as e:</code> block catches it because <code>ConnectionError</code>, <code>Timeout</code>, and <code>HTTPError</code> are all descendants of <code>RequestException</code>.</li>
<li>We print a helpful message and the details of the error (<code>e</code>). Crucially, the script <em>doesn't crash</em>.</li>
</ul>
<p><b>Example 2: Catching Specific Errors</b></p>
<p>Sometimes, you want to react differently based on the <em>type</em> of error. Was it a temporary network glitch, or did the server permanently remove the page?</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> requests</div>
<div class="line"> </div>
<div class="line"><span class="comment"># URL that gives a 404 error</span></div>
<div class="line">not_found_url = <span class="stringliteral">&#39;https://httpbin.org/status/404&#39;</span></div>
<div class="line"><span class="comment"># URL that is slow and might time out</span></div>
<div class="line">timeout_url = <span class="stringliteral">&#39;https://httpbin.org/delay/5&#39;</span> <span class="comment"># Delays response by 5 seconds</span></div>
<div class="line"> </div>
<div class="line">url_to_try = timeout_url <span class="comment"># Change to not_found_url to see HTTPError</span></div>
<div class="line"> </div>
<div class="line">print(f<span class="stringliteral">&quot;Trying to fetch: {url_to_try}&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">try</span>:</div>
<div class="line">    <span class="comment"># Set a short timeout to demonstrate Timeout exception</span></div>
<div class="line">    response = requests.get(url_to_try, timeout=2)</div>
<div class="line">    response.raise_for_status() <span class="comment"># Check for 4xx/5xx status codes</span></div>
<div class="line">    print(<span class="stringliteral">&quot;Success! Status Code:&quot;</span>, response.status_code)</div>
<div class="line">    <span class="comment"># Process response...</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">except</span> requests.exceptions.ConnectTimeout <span class="keyword">as</span> e:</div>
<div class="line">    print(f<span class="stringliteral">&quot;\nError: Could not connect to the server in time.&quot;</span>)</div>
<div class="line">    print(f<span class="stringliteral">&quot;Details: {e}&quot;</span>)</div>
<div class="line">    <span class="comment"># Maybe retry later?</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">except</span> requests.exceptions.ReadTimeout <span class="keyword">as</span> e:</div>
<div class="line">    print(f<span class="stringliteral">&quot;\nError: Server took too long to send data.&quot;</span>)</div>
<div class="line">    print(f<span class="stringliteral">&quot;Details: {e}&quot;</span>)</div>
<div class="line">    <span class="comment"># Maybe the server is slow, could try again?</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">except</span> requests.exceptions.ConnectionError <span class="keyword">as</span> e:</div>
<div class="line">    print(f<span class="stringliteral">&quot;\nError: Network problem (e.g., DNS error, refused connection).&quot;</span>)</div>
<div class="line">    print(f<span class="stringliteral">&quot;Details: {e}&quot;</span>)</div>
<div class="line">    <span class="comment"># Check internet connection?</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">except</span> requests.exceptions.HTTPError <span class="keyword">as</span> e:</div>
<div class="line">    print(f<span class="stringliteral">&quot;\nError: Bad HTTP status code received from server.&quot;</span>)</div>
<div class="line">    print(f<span class="stringliteral">&quot;Status Code: {e.response.status_code}&quot;</span>)</div>
<div class="line">    print(f<span class="stringliteral">&quot;Details: {e}&quot;</span>)</div>
<div class="line">    <span class="comment"># Was it a 404 Not Found? 500 Server Error?</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</div>
<div class="line">    <span class="comment"># Catch any other requests error that wasn&#39;t specifically handled above</span></div>
<div class="line">    print(f<span class="stringliteral">&quot;\nAn unexpected requests error occurred:&quot;</span>)</div>
<div class="line">    print(f<span class="stringliteral">&quot;Error Type: {type(e).__name__}&quot;</span>)</div>
<div class="line">    print(f<span class="stringliteral">&quot;Details: {e}&quot;</span>)</div>
<div class="line"> </div>
<div class="line">print(<span class="stringliteral">&quot;\nScript continues...&quot;</span>)</div>
</div><!-- fragment --><p><b>Possible Output (if <code>url_to_try = timeout_url</code>):</b></p>
<div class="fragment"><div class="line">Trying to fetch: https://httpbin.org/delay/5</div>
<div class="line"> </div>
<div class="line">Error: Server took too long to send data.</div>
<div class="line">Details: HTTPSConnectionPool(host=&#39;httpbin.org&#39;, port=443): Read timed out. (read timeout=2)</div>
<div class="line"> </div>
<div class="line">Script continues...</div>
</div><!-- fragment --><p><b>Possible Output (if <code>url_to_try = not_found_url</code>):</b></p>
<div class="fragment"><div class="line">Trying to fetch: https://httpbin.org/status/404</div>
<div class="line"> </div>
<div class="line">Error: Bad HTTP status code received from server.</div>
<div class="line">Status Code: 404</div>
<div class="line">Details: 404 Client Error: NOT FOUND for url: https://httpbin.org/status/404</div>
<div class="line"> </div>
<div class="line">Script continues...</div>
</div><!-- fragment --><p><b>Explanation:</b></p>
<ul>
<li>We have multiple <code>except</code> blocks, ordered from most specific (<code>ConnectTimeout</code>, <code>ReadTimeout</code>) to more general (<code>ConnectionError</code>, <code>HTTPError</code>) and finally the catch-all <code>RequestException</code>.</li>
<li>Python tries the <code>except</code> blocks in order. When an exception occurs, the <em>first</em> matching block is executed.</li>
<li>If a <code>ReadTimeout</code> occurs, the <code>except requests.exceptions.ReadTimeout</code> block handles it. It won't fall through to the <code>except requests.exceptions.ConnectionError</code> or <code>except requests.exceptions.RequestException</code> blocks, even though <code>ReadTimeout</code> <em>is</em> a type of <code>RequestException</code>.</li>
<li>This allows us to provide specific feedback or recovery logic for different error scenarios.</li>
</ul>
<p><b>Inheritance Benefit:</b> If you write <code>except requests.exceptions.Timeout as e:</code>, this block will catch <em>both</em> <code>ConnectTimeout</code> and <code>ReadTimeout</code> because they inherit from <code>Timeout</code>.</p>
<h2><a class="anchor" id="autotoc_md2972"></a>
How It Works Internally: Wrapping Lower-Level Errors</h2>
<p><code>Requests</code> doesn't handle network connections directly. It uses a lower-level library called <code>urllib3</code> under the hood (managed via <a class="el" href="../../d5/d83/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Requests_207__transport__adapters.html">Transport Adapters</a>). When <code>urllib3</code> encounters a network problem (like a connection error or timeout), it raises its <em>own</em> specific exceptions (e.g., <code>urllib3.exceptions.MaxRetryError</code>, <code>urllib3.exceptions.NewConnectionError</code>, <code>urllib3.exceptions.ReadTimeoutError</code>).</p>
<p><code>Requests</code> catches these <code>urllib3</code> exceptions inside its <a class="el" href="../../d5/d83/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Requests_207__transport__adapters.html">Transport Adapters</a> (specifically, the <code>HTTPAdapter.send</code> method) and then <b>raises its own corresponding exception</b> from the <code>requests.exceptions</code> hierarchy. This simplifies things for you â€“ you only need to worry about catching <code>requests</code> exceptions, not the underlying <code>urllib3</code> ones.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant UserCode as Your Code</div>
<div class="line">    participant ReqAPI as requests.get()</div>
<div class="line">    participant Adapter as HTTPAdapter</div>
<div class="line">    participant Urllib3 as urllib3 library</div>
<div class="line">    participant Network</div>
<div class="line"> </div>
<div class="line">    UserCode-&gt;&gt;ReqAPI: requests.get(bad_url, timeout=1)</div>
<div class="line">    ReqAPI-&gt;&gt;Adapter: send(prepared_request)</div>
<div class="line">    Adapter-&gt;&gt;Urllib3: urlopen(method, url, ..., timeout=1)</div>
<div class="line">    Urllib3-&gt;&gt;Network: Attempt connection...</div>
<div class="line">    Network--&gt;&gt;Urllib3: Fails (e.g., DNS lookup fails)</div>
<div class="line">    Urllib3-&gt;&gt;Urllib3: Raise urllib3.exceptions.NewConnectionError</div>
<div class="line">    Urllib3--&gt;&gt;Adapter: Propagate NewConnectionError</div>
<div class="line">    Adapter-&gt;&gt;Adapter: Catch NewConnectionError</div>
<div class="line">    Adapter-&gt;&gt;Adapter: Raise requests.exceptions.ConnectionError(original_error)</div>
<div class="line">    Adapter--&gt;&gt;ReqAPI: Propagate ConnectionError</div>
<div class="line">    ReqAPI--&gt;&gt;UserCode: Propagate ConnectionError</div>
<div class="line">    UserCode-&gt;&gt;UserCode: Catch requests.exceptions.ConnectionError</div>
</div><!-- fragment --><p>Let's look at the definitions in <code>requests/exceptions.py</code>. You can see the inheritance structure clearly:</p>
<div class="fragment"><div class="line"><span class="comment"># File: requests/exceptions.py (Simplified View)</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> urllib3.exceptions <span class="keyword">import</span> HTTPError <span class="keyword">as</span> BaseHTTPError</div>
<div class="line"> </div>
<div class="line"><span class="comment"># The base class for all requests exceptions</span></div>
<div class="line"><span class="keyword">class </span>RequestException(IOError):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;There was an ambiguous exception that occurred while handling your request.&quot;&quot;&quot;</span></div>
<div class="line">    <span class="comment"># ... (stores request/response objects) ...</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Specific exceptions inheriting from RequestException or other requests exceptions</span></div>
<div class="line"><span class="keyword">class </span>HTTPError(RequestException):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;An HTTP error occurred.&quot;&quot;&quot;</span> <span class="comment"># Typically raised by response.raise_for_status()</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ConnectionError(RequestException):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;A Connection error occurred.&quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ProxyError(ConnectionError): <span class="comment"># Inherits from ConnectionError</span></div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;A proxy error occurred.&quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>SSLError(ConnectionError): <span class="comment"># Inherits from ConnectionError</span></div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;An SSL error occurred.&quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Timeout(RequestException): <span class="comment"># Inherits directly from RequestException</span></div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;The request timed out.&quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ConnectTimeout(ConnectionError, Timeout): <span class="comment"># Inherits from BOTH ConnectionError and Timeout!</span></div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;The request timed out while trying to connect to the remote server.&quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ReadTimeout(Timeout): <span class="comment"># Inherits from Timeout</span></div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;The server did not send any data in the allotted amount of time.&quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>URLRequired(RequestException):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;A valid URL is required to make a request.&quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>TooManyRedirects(RequestException):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;Too many redirects.&quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># ... other specific errors like MissingSchema, InvalidURL, etc. ...</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Some exceptions might also inherit from standard Python errors</span></div>
<div class="line"><span class="keyword">class </span>JSONDecodeError(RequestException, ValueError): <span class="comment"># Inherits from RequestException and ValueError</span></div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;Couldn&#39;t decode the text into json&quot;&quot;&quot;</span></div>
<div class="line">    <span class="comment"># Uses Python&#39;s built-in JSONDecodeError capabilities</span></div>
</div><!-- fragment --><p>And here's a simplified view of how <code>requests/adapters.py</code> (<code>HTTPAdapter.send</code>) catches <code>urllib3</code> errors and raises <code>requests</code> errors:</p>
<div class="fragment"><div class="line"><span class="comment"># File: requests/adapters.py (Simplified View in HTTPAdapter.send method)</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">from</span> urllib3.exceptions <span class="keyword">import</span> (</div>
<div class="line">    MaxRetryError, ConnectTimeoutError, NewConnectionError, ResponseError,</div>
<div class="line">    ProxyError <span class="keyword">as</span> _ProxyError, SSLError <span class="keyword">as</span> _SSLError, ReadTimeoutError,</div>
<div class="line">    ProtocolError, ClosedPoolError, InvalidHeader <span class="keyword">as</span> _InvalidHeader</div>
<div class="line">)</div>
<div class="line"><span class="keyword">from</span> ..exceptions <span class="keyword">import</span> (</div>
<div class="line">    ConnectionError, ConnectTimeout, ReadTimeout, SSLError, ProxyError,</div>
<div class="line">    RetryError, InvalidHeader, RequestException <span class="comment"># And others</span></div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>HTTPAdapter(BaseAdapter):</div>
<div class="line">    <span class="keyword">def </span>send(self, request, stream=False, timeout=None, verify=True, cert=None, proxies=None):</div>
<div class="line">        <span class="comment"># ... (prepare connection using self.get_connection_with_tls_context) ...</span></div>
<div class="line">        conn = self.get_connection_with_tls_context(...)</div>
<div class="line">        <span class="comment"># ... (verify certs, prepare URL, add headers) ...</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">try</span>:</div>
<div class="line">            <span class="comment"># === Make the actual request using urllib3 ===</span></div>
<div class="line">            resp = conn.urlopen(</div>
<div class="line">                method=request.method,</div>
<div class="line">                url=url,</div>
<div class="line">                <span class="comment"># ... other args like body, headers ...</span></div>
<div class="line">                retries=self.max_retries,</div>
<div class="line">                timeout=timeout,</div>
<div class="line">            )</div>
<div class="line"> </div>
<div class="line">        <span class="comment"># === Catch specific urllib3 errors and raise corresponding requests errors ===</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">except</span> (ProtocolError, OSError) <span class="keyword">as</span> err: <span class="comment"># General network/protocol errors</span></div>
<div class="line">            <span class="keywordflow">raise</span> ConnectionError(err, request=request)</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">except</span> MaxRetryError <span class="keyword">as</span> e: <span class="comment"># urllib3 retried but failed</span></div>
<div class="line">            <span class="keywordflow">if</span> isinstance(e.reason, ConnectTimeoutError):</div>
<div class="line">                <span class="keywordflow">raise</span> ConnectTimeout(e, request=request)</div>
<div class="line">            <span class="keywordflow">if</span> isinstance(e.reason, ResponseError): <span class="comment"># Errors related to retry logic</span></div>
<div class="line">                <span class="keywordflow">raise</span> RetryError(e, request=request)</div>
<div class="line">            <span class="keywordflow">if</span> isinstance(e.reason, _ProxyError):</div>
<div class="line">                <span class="keywordflow">raise</span> ProxyError(e, request=request)</div>
<div class="line">            <span class="keywordflow">if</span> isinstance(e.reason, _SSLError):</div>
<div class="line">                <span class="keywordflow">raise</span> SSLError(e, request=request)</div>
<div class="line">            <span class="comment"># Fallback for other retry errors</span></div>
<div class="line">            <span class="keywordflow">raise</span> ConnectionError(e, request=request)</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">except</span> ClosedPoolError <span class="keyword">as</span> e: <span class="comment"># Connection pool was closed</span></div>
<div class="line">            <span class="keywordflow">raise</span> ConnectionError(e, request=request)</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">except</span> _ProxyError <span class="keyword">as</span> e: <span class="comment"># Direct proxy error</span></div>
<div class="line">            <span class="keywordflow">raise</span> ProxyError(e)</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">except</span> (_SSLError, ReadTimeoutError, _InvalidHeader) <span class="keyword">as</span> e: <span class="comment"># Other specific errors</span></div>
<div class="line">            <span class="keywordflow">if</span> isinstance(e, _SSLError):</div>
<div class="line">                <span class="keywordflow">raise</span> SSLError(e, request=request)</div>
<div class="line">            <span class="keywordflow">elif</span> isinstance(e, ReadTimeoutError):</div>
<div class="line">                <span class="keywordflow">raise</span> ReadTimeout(e, request=request)</div>
<div class="line">            <span class="keywordflow">elif</span> isinstance(e, _InvalidHeader):</div>
<div class="line">                <span class="keywordflow">raise</span> InvalidHeader(e, request=request)</div>
<div class="line">            <span class="keywordflow">else</span>:</div>
<div class="line">                <span class="comment"># Should not happen, but raise generic RequestException if needed</span></div>
<div class="line">                <span class="keywordflow">raise</span> RequestException(e, request=request)</div>
<div class="line"> </div>
<div class="line">        <span class="comment"># ... (build and return the Response object if successful) ...</span></div>
<div class="line">        <span class="keywordflow">return</span> self.build_response(request, resp)</div>
</div><!-- fragment --><p>This wrapping makes your life easier by providing a consistent set of exceptions (<code>requests.exceptions</code>) to handle, regardless of the underlying <code>urllib3</code> details.</p>
<h2><a class="anchor" id="autotoc_md2973"></a>
Conclusion</h2>
<p>You've learned about the <code>requests</code> <b>Exception Hierarchy</b> â€“ a family tree of error types that <code>requests</code> raises when things go wrong.</p>
<ul>
<li>You saw that all <code>requests</code> exceptions inherit from the base <code>requests.exceptions.RequestException</code>.</li>
<li>You learned about key specific exceptions like <code>ConnectionError</code>, <code>Timeout</code> (and its children <code>ConnectTimeout</code>, <code>ReadTimeout</code>), and <code>HTTPError</code> (raised by <code>response.raise_for_status()</code>).</li>
<li>You practiced using <code>try...except</code> blocks to catch both general (<code>RequestException</code>) and specific exceptions, allowing for tailored error handling.</li>
<li>You understood that <code>requests</code> wraps lower-level errors (from <code>urllib3</code>) into its own exception types, simplifying error handling for you.</li>
</ul>
<p>Understanding this hierarchy is crucial for writing robust Python code that can gracefully handle the inevitable problems that occur when dealing with networks and web services.</p>
<p>So far, we've mostly used the default way <code>requests</code> handles connections. But what if we need more control over how connections are made, maybe to configure retries differently, or use different SSL settings? That's where Transport Adapters come in.</p>
<p><b>Next:</b> <a class="el" href="../../d5/d83/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Requests_207__transport__adapters.html">Chapter 7: Transport Adapters</a></p>
<hr  />
<p>Generated by <a href="https://github.com/The-Pocket/Tutorial-Codebase-Knowledge">AI Codebase Knowledge Builder</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
