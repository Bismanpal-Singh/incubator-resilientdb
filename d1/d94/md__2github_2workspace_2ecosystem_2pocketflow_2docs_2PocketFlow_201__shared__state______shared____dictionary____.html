#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ResilientDB: 01_shared_state___shared__dictionary__</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d1/d94/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_201__shared__state______shared____dictionary____.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">01_shared_state___shared__dictionary__</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md2684"></a>
autotoc_md2684</h2>
<p>layout: default title: "Shared State (Shared Dictionary)" parent: "PocketFlow" </p>
<h2><a class="anchor" id="autotoc_md2685"></a>
nav_order: 1</h2>
<h1><a class="anchor" id="autotoc_md2686"></a>
Chapter 1: Shared State (<code>shared</code> dictionary)</h1>
<p>Welcome to your first step into the world of PocketFlow! Building powerful AI applications often involves breaking down complex tasks into smaller, manageable steps. But how do these steps communicate with each other? How does one part of your AI know what another part has done or figured out? That's where the <b><code>shared</code> dictionary</b> comes into play.</p>
<p>Imagine you're building a simple AI assistant.</p><ol type="1">
<li>First, it needs to get your question (e.g., "What's the weather like in London?").</li>
<li>Then, it might need to search the web for "weather in London."</li>
<li>Finally, it uses your original question and the search results to give you an answer.</li>
</ol>
<p>For this to work, the "question understanding" step needs to pass the question to the "web searching" step. Then, both the original question and the search results need to be available to the "answering" step. The <code>shared</code> dictionary is the magic message board that lets all these steps share information.</p>
<h2><a class="anchor" id="autotoc_md2687"></a>
What is the <code>shared</code> Dictionary?</h2>
<p>At its heart, the <code>shared</code> dictionary is a standard Python dictionary (<code>dict</code>). Think of it like a <b>communal backpack</b> or a <b>shared whiteboard</b>. As your PocketFlow application (which we call a <a class="el" href="../../dd/de4/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_204__flow______flow________asyncflow______.html">Flow (<code>Flow</code>, <code>AsyncFlow</code>)</a>) runs, different components (which we call <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Nodes (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a>) can:</p><ul>
<li><b>Put things into it</b> (write data).</li>
<li><b>Look at what's inside</b> (read data).</li>
<li><b>Update things</b> that are already there.</li>
</ul>
<p>This <code>shared</code> dictionary becomes the primary way for different parts of your workflow to pass data, intermediate results, and context to each other. It's available throughout the entire lifecycle of a single execution of a <a class="el" href="../../dd/de4/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_204__flow______flow________asyncflow______.html">Flow (<code>Flow</code>, <code>AsyncFlow</code>)</a>.</p>
<h2><a class="anchor" id="autotoc_md2688"></a>
How to Use the <code>shared</code> Dictionary</h2>
<p>Let's see how this works with a few simple examples.</p>
<p><b>1. Initializing <code>shared</code> with Starting Data</b></p>
<p>Before your <a class="el" href="../../dd/de4/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_204__flow______flow________asyncflow______.html">Flow (<code>Flow</code>, <code>AsyncFlow</code>)</a> even starts, you usually prepare some initial data. This data is placed into the <code>shared</code> dictionary.</p>
<p>Consider this snippet from one of our example projects (<code>cookbook/pocketflow-node/main.py</code>): </p><div class="fragment"><div class="line"><span class="comment"># This is how we can start with some data</span></div>
<div class="line">text_to_summarize = <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">PocketFlow is a minimalist LLM framework...</span></div>
<div class="line"><span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line">shared = {<span class="stringliteral">&quot;data&quot;</span>: text_to_summarize}</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Later, this &#39;shared&#39; dictionary is passed when running the flow:</span></div>
<div class="line"><span class="comment"># flow.run(shared)</span></div>
</div><!-- fragment --><p> In this code:</p><ul>
<li>We have some <code>text_to_summarize</code>.</li>
<li>We create a Python dictionary named <code>shared</code>.</li>
<li>We add an entry to this dictionary: the key is <code>"data"</code> and its value is our <code>text_to_summarize</code>. When the <a class="el" href="../../dd/de4/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_204__flow______flow________asyncflow______.html">Flow (<code>Flow</code>, <code>AsyncFlow</code>)</a> starts, this <code>shared</code> dictionary will be its starting point.</li>
</ul>
<p>Here's another example from <code>cookbook/pocketflow-a2a/main.py</code> where a question is put into <code>shared</code>: </p><div class="fragment"><div class="line"><span class="comment"># Default question or one from command line</span></div>
<div class="line">question = <span class="stringliteral">&quot;Who won the Nobel Prize in Physics 2024?&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Process the question</span></div>
<div class="line">shared = {<span class="stringliteral">&quot;question&quot;</span>: question}</div>
<div class="line"><span class="comment"># agent_flow.run(shared)</span></div>
</div><!-- fragment --><p> Here, the <code>shared</code> dictionary is initialized with the <code>question</code> under the key <code>"question"</code>.</p>
<p><b>2. A <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> Reading from <code>shared</code></b></p>
<p><a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Nodes (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> are the workers in your <a class="el" href="../../dd/de4/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_204__flow______flow________asyncflow______.html">Flow (<code>Flow</code>, <code>AsyncFlow</code>)</a>. They often need to read data from the <code>shared</code> dictionary to know what to do. This usually happens in a Node's <code>prep</code> method.</p>
<p>Let's look at the <code>Summarize</code> <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> from <code>cookbook/pocketflow-node/flow.py</code>: </p><div class="fragment"><div class="line"><span class="comment"># Inside the Summarize Node class</span></div>
<div class="line"><span class="comment"># def prep(self, shared):</span></div>
<div class="line"><span class="comment">#     &quot;&quot;&quot;Read and preprocess data from shared store.&quot;&quot;&quot;</span></div>
<div class="line"><span class="comment">#     return shared[&quot;data&quot;] # Accesses the &#39;data&#39; we set earlier</span></div>
</div><!-- fragment --><p> When this <code>Summarize</code> <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> is about to run, its <code>prep</code> method is called. PocketFlow automatically passes the current <code>shared</code> dictionary to this method. The line <code>shared["data"]</code> retrieves the value associated with the key <code>"data"</code> – which is the text we want to summarize.</p>
<p>Another example from <code>cookbook/pocketflow-a2a/nodes.py</code>, in the <code>DecideAction</code> <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a>: </p><div class="fragment"><div class="line"><span class="comment"># Inside the DecideAction Node&#39;s prep method</span></div>
<div class="line"><span class="comment"># def prep(self, shared):</span></div>
<div class="line"><span class="comment"># Get the current context (default if none exists)</span></div>
<div class="line">context = shared.get(<span class="stringliteral">&quot;context&quot;</span>, <span class="stringliteral">&quot;No previous search&quot;</span>)</div>
<div class="line"><span class="comment"># Get the question from the shared store</span></div>
<div class="line">question = shared[<span class="stringliteral">&quot;question&quot;</span>]</div>
<div class="line"><span class="keywordflow">return</span> question, context</div>
</div><!-- fragment --><p> This <code>prep</code> method reads two items:</p><ul>
<li><code>shared.get("context", "No previous search")</code>: This tries to get the value for the key <code>"context"</code>. If <code>"context"</code> isn't found (maybe it's the first time this runs), it defaults to <code>"No previous search"</code>. Using <code>.<a class="el" href="../../d7/da6/pybind__kv__service_8cpp.html#abe6524afb3a69dc9a4c314e11f96f29f">get()</a></code> is a safe way to read, as it prevents errors if a key might be missing.</li>
<li><code>shared["question"]</code>: This directly retrieves the value for the key <code>"question"</code>, assuming it will always be there.</li>
</ul>
<p><b>3. A <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> Writing Results Back to <code>shared</code></b></p>
<p>After a <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> does its work (e.g., summarizes text, gets search results), it often needs to save its findings back into the <code>shared</code> dictionary. This typically happens in a Node's <code>post</code> method.</p>
<p>Continuing with our <code>Summarize</code> <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> (<code>cookbook/pocketflow-node/flow.py</code>): </p><div class="fragment"><div class="line"><span class="comment"># Inside the Summarize Node class</span></div>
<div class="line"><span class="comment"># &#39;exec_res&#39; below is the result from the Node&#39;s main task</span></div>
<div class="line"><span class="comment"># def post(self, shared, prep_res, exec_res):</span></div>
<div class="line"><span class="comment">#     &quot;&quot;&quot;Store the summary in shared store.&quot;&quot;&quot;</span></div>
<div class="line"><span class="comment">#     shared[&quot;summary&quot;] = exec_res # Stores the result</span></div>
</div><!-- fragment --><p> Here, <code>exec_res</code> holds the summary generated by the <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a>. The line <code>shared["summary"] = exec_res</code> creates a new key <code>"summary"</code> in the <code>shared</code> dictionary (or updates it if it already exists) and stores the summary there. Now, subsequent <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Nodes (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> can access this summary!</p>
<p>Similarly, in <code>DecideAction</code>'s <code>post</code> method (<code>cookbook/pocketflow-a2a/nodes.py</code>): </p><div class="fragment"><div class="line"><span class="comment"># Inside DecideAction Node&#39;s post method</span></div>
<div class="line"><span class="comment"># def post(self, shared, prep_res, exec_res):</span></div>
<div class="line"><span class="comment"># &#39;exec_res&#39; contains the decision made by an LLM</span></div>
<div class="line"><span class="keywordflow">if</span> exec_res[<span class="stringliteral">&quot;action&quot;</span>] == <span class="stringliteral">&quot;search&quot;</span>:</div>
<div class="line">    shared[<span class="stringliteral">&quot;search_query&quot;</span>] = exec_res[<span class="stringliteral">&quot;search_query&quot;</span>]</div>
<div class="line">    <span class="comment"># ...</span></div>
<div class="line"><span class="keywordflow">else</span>:</div>
<div class="line">    shared[<span class="stringliteral">&quot;context&quot;</span>] = exec_res[<span class="stringliteral">&quot;answer&quot;</span>]</div>
<div class="line">    <span class="comment"># ...</span></div>
<div class="line"><span class="comment"># ...</span></div>
</div><!-- fragment --><p> Depending on the <code>action</code> decided, this <code>post</code> method writes either a <code>"search_query"</code> or an updated <code>"context"</code> (which is the answer) into the <code>shared</code> dictionary.</p>
<p><b>4. Modifying Existing Data in <code>shared</code></b></p>
<p>Sometimes, a <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> needs to update or add to existing information in <code>shared</code>. For example, in a chat application, you maintain a history of messages.</p>
<p>From <code>cookbook/pocketflow-chat/main.py</code>, the <code>ChatNode</code>'s <code>prep</code> method does this: </p><div class="fragment"><div class="line"><span class="comment"># Inside ChatNode&#39;s prep method</span></div>
<div class="line"><span class="comment"># def prep(self, shared):</span></div>
<div class="line"><span class="comment"># Initialize messages if this is the first run</span></div>
<div class="line"><span class="keywordflow">if</span> <span class="stringliteral">&quot;messages&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> shared:</div>
<div class="line">    shared[<span class="stringliteral">&quot;messages&quot;</span>] = [] <span class="comment"># Create an empty list if no history</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># ... user_input is obtained ...</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Add user message to history</span></div>
<div class="line">shared[<span class="stringliteral">&quot;messages&quot;</span>].append({<span class="stringliteral">&quot;role&quot;</span>: <span class="stringliteral">&quot;user&quot;</span>, <span class="stringliteral">&quot;content&quot;</span>: user_input})</div>
<div class="line"><span class="comment"># ...</span></div>
</div><!-- fragment --><p> Here:</p><ol type="1">
<li>It checks if <code>"messages"</code> (our chat history) exists in <code>shared</code>. If not, it initializes <code>shared["messages"]</code> as an empty list.</li>
<li>It then appends the new user message to this list. The <code>shared["messages"]</code> list grows with each turn of the conversation.</li>
</ol>
<p><b>5. Accessing Final Results from <code>shared</code></b></p>
<p>Once your <a class="el" href="../../dd/de4/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_204__flow______flow________asyncflow______.html">Flow (<code>Flow</code>, <code>AsyncFlow</code>)</a> has completed all its steps, the <code>shared</code> dictionary will contain the final outputs and any important intermediate data you chose to store. You can then access these results from your main script.</p>
<p>Back to <code>cookbook/pocketflow-node/main.py</code>: </p><div class="fragment"><div class="line"><span class="comment"># After the flow.run(shared) call:</span></div>
<div class="line"><span class="comment"># The &#39;shared&#39; dictionary now contains the summary</span></div>
<div class="line"> </div>
<div class="line">print(<span class="stringliteral">&quot;\nSummary:&quot;</span>, shared[<span class="stringliteral">&quot;summary&quot;</span>])</div>
</div><!-- fragment --><p> This line simply prints the value associated with the key <code>"summary"</code> from the <code>shared</code> dictionary, which was put there by the <code>Summarize</code> <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a>.</p>
<h2><a class="anchor" id="autotoc_md2689"></a>
Key Characteristics of <code>shared</code></h2>
<ul>
<li><b>It's a Python Dictionary:</b> This makes it incredibly flexible and easy to use. If you know how to use dictionaries in Python (e.g., &lsquo;my_dict['key&rsquo;] = value<code>,</code>value = my_dict['key']<code>,</code>my_dict.get('key', default_value)<code>), you already know how to interact with</code>shared<code>.</code></li>
<li><code> **Scoped to a Single Flow Execution:** Each time you run a [Flow (</code>Flow<code>,</code>AsyncFlow<code>)](<a class="el" href="../../d9/ded/04__flow______flow________asyncflow_______8md.html">04_flow___flow____asyncflow___.md</a>) (e.g., by calling</code>flow.run(shared_input)<code>), it operates on its own instance of the</code>shared<code>dictionary. If you run the same [Flow (</code>Flow<code>,</code>AsyncFlow<code>)](<a class="el" href="../../d9/ded/04__flow______flow________asyncflow_______8md.html">04_flow___flow____asyncflow___.md</a>) twice, even simultaneously for different requests, they will have completely separate</code>shared<code>dictionaries. They won't interfere with each other. Think of it like two people filling out their own copies of the same form.</code></li>
<li><code> **Persistent Throughout One Flow Execution:** The</code>shared<code>dictionary is created (or you provide an initial one) when a [Flow (</code>Flow<code>,</code>AsyncFlow<code>)](<a class="el" href="../../d9/ded/04__flow______flow________asyncflow_______8md.html">04_flow___flow____asyncflow___.md</a>) starts. The *exact same* dictionary object is then passed from one [Node (</code>BaseNode<code>,</code>Node<code>,</code>AsyncNode<code>)](<a class="el" href="../../d0/dd7/02__node______basenode________node________asyncnode_______8md.html">02_node___basenode____node____asyncnode___.md</a>) to the next. Any modifications made by one [Node (</code>BaseNode<code>,</code>Node<code>,</code>AsyncNode<code>)](<a class="el" href="../../d0/dd7/02__node______basenode________node________asyncnode_______8md.html">02_node___basenode____node____asyncnode___.md</a>) are visible to all subsequent [Nodes (</code>BaseNode<code>,</code>Node<code>,</code>AsyncNode`)](<a class="el" href="../../d0/dd7/02__node______basenode________node________asyncnode_______8md.html">02_node___basenode____node____asyncnode___.md</a>).</li>
</ul>
<h2><a class="anchor" id="autotoc_md2690"></a>
What Happens Under the Hood? (A Simplified View)</h2>
<p>You don't need to manage the passing of the <code>shared</code> dictionary yourself; PocketFlow handles it for you. Here's a simplified step-by-step:</p>
<ol type="1">
<li><b>You start a Flow:</b> You call something like <code>my_flow.run(initial_shared_data)</code>. <code>initial_shared_data</code> is the dictionary you've prepared.</li>
<li><b>PocketFlow takes over:</b> It takes your <code>initial_shared_data</code> and passes it to the first <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> in your <a class="el" href="../../dd/de4/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_204__flow______flow________asyncflow______.html">Flow (<code>Flow</code>, <code>AsyncFlow</code>)</a>.</li>
<li><b>Node executes:</b><ul>
<li>The <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a>'s <code>prep</code> method is called with the <code>shared</code> dictionary. It can read from it.</li>
<li>The <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a>'s <code>exec</code> method (the main workhorse) is called.</li>
<li>The <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a>'s <code>post</code> method is called with the <code>shared</code> dictionary. It can write results back to it.</li>
</ul>
</li>
<li><b>Pass it on:</b> PocketFlow determines the next <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> to run and passes the <em>same, possibly modified</em>, <code>shared</code> dictionary to it.</li>
<li><b>Repeat:</b> Steps 3 and 4 repeat until there are no more <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Nodes (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> to run in the <a class="el" href="../../dd/de4/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_204__flow______flow________asyncflow______.html">Flow (<code>Flow</code>, <code>AsyncFlow</code>)</a>.</li>
<li><b>Flow ends:</b> The <code>run</code> method finishes, and the <code>shared</code> dictionary you originally passed in now contains all the updates made by the <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Nodes (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a>.</li>
</ol>
<p>Here's a visual way to think about it:</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant You</div>
<div class="line">    participant PocketFlowEngine as PocketFlow Engine</div>
<div class="line">    participant NodeA as First Node</div>
<div class="line">    participant NodeB as Second Node</div>
<div class="line">    participant SharedDict as Shared Dictionary</div>
<div class="line"> </div>
<div class="line">    You-&gt;&gt;PocketFlowEngine: my_flow.run(initial_shared)</div>
<div class="line">    PocketFlowEngine-&gt;&gt;SharedDict: Initialize with initial_shared</div>
<div class="line">    PocketFlowEngine-&gt;&gt;NodeA: process(SharedDict)</div>
<div class="line">    NodeA-&gt;&gt;SharedDict: Reads input (e.g., shared[&#39;question&#39;])</div>
<div class="line">    NodeA-&gt;&gt;SharedDict: Writes output (e.g., shared[&#39;data_from_A&#39;] = ...)</div>
<div class="line">    PocketFlowEngine-&gt;&gt;NodeB: process(SharedDict)</div>
<div class="line">    NodeB-&gt;&gt;SharedDict: Reads input (e.g., shared[&#39;data_from_A&#39;])</div>
<div class="line">    NodeB-&gt;&gt;SharedDict: Writes output (e.g., shared[&#39;final_answer&#39;] = ...)</div>
<div class="line">    PocketFlowEngine-&gt;&gt;You: Flow complete (initial_shared is now updated)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md2691"></a>
Analogy Time!</h2>
<p>Think of the <code>shared</code> dictionary as:</p>
<ul>
<li><b>A Relay Race Baton (but smarter!):</b> Each runner (<a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a>) takes the baton (<code>shared</code> dictionary), maybe adds a small note or a sticker to it, and then passes it to the next runner. By the end of the race, the baton has collected contributions from everyone.</li>
<li><b>A Project's Shared Folder:</b> Imagine a team working on a project. They have a shared folder (<code>shared</code> dictionary) on a server. The first person creates a document (initial data). The next person opens it, adds their part, and saves it. The next person does the same. Everyone works on the same set of files in that folder.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2692"></a>
Conclusion</h2>
<p>You've now learned about the <code>shared</code> dictionary, the backbone of communication within a PocketFlow <a class="el" href="../../dd/de4/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_204__flow______flow________asyncflow______.html">Flow (<code>Flow</code>, <code>AsyncFlow</code>)</a>. It's a simple yet powerful Python dictionary that allows different <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Nodes (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> to share data and context seamlessly. By reading from and writing to <code>shared</code>, your <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Nodes (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a> can collaborate to achieve complex tasks.</p>
<p>Now that you understand how data is passed around, you're probably wondering about the "workers" themselves – the <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Nodes (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a>. What are they, and how do you build them? Let's dive into that in the next chapter!</p>
<p>Next up: <a class="el" href="../../dc/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2PocketFlow_202__node______basenode________node________asyncnode______.html">Chapter 2: Node (<code>BaseNode</code>, <code>Node</code>, <code>AsyncNode</code>)</a></p>
<hr  />
<p>Generated by <a href="https://github.com/The-Pocket/Tutorial-Codebase-Knowledge">AI Codebase Knowledge Builder</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
