#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ResilientDB: 02_fastmcp_server___fastmcp__</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d8/d5c/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2MCP_01Python_01SDK_202__fastmcp__server______fastmcp____.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">02_fastmcp_server___fastmcp__</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md2359"></a>
autotoc_md2359</h2>
<p>layout: default title: "FastMCP Server (FastMCP)" parent: "MCP Python SDK" </p>
<h2><a class="anchor" id="autotoc_md2360"></a>
nav_order: 2</h2>
<h1><a class="anchor" id="autotoc_md2361"></a>
Chapter 2: Easier Server Building with <code>FastMCP</code></h1>
<p>In <a class="el" href="../../d2/d9f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2MCP_01Python_01SDK_201__cli______mcp____command__.html">Chapter 1: Your Control Panel - The <code>mcp</code> Command-Line Interface</a>, we learned how to use the <code>mcp</code> command to run, test, and install MCP servers. We even saw a tiny example of a server file. But how do we <em>build</em> that server code without getting lost in complex details?</p>
<p>Imagine you want to build a simple AI assistant that can just echo back whatever you type. Writing all the code to handle connections, interpret messages according to the MCP protocol, manage capabilities â€“ it sounds like a lot of work just for an echo!</p>
<p>This is where <code>FastMCP</code> comes in. It's designed to make building MCP servers much, much easier.</p>
<h2><a class="anchor" id="autotoc_md2362"></a>
What is <code>FastMCP</code>?</h2>
<p>Think of the low-level parts of the MCP protocol like individual kitchen tools: a pot, a pan, a knife, a whisk. You <em>could</em> use them all individually to cook a meal, but you'd need to know exactly when and how to use each one.</p>
<p><code>FastMCP</code> is like a fancy <b>kitchen multi-cooker</b>. It bundles many common functions together in an easy-to-use package. You provide the ingredients (your Python functions and data) and press simple buttons (special markers called <b>decorators</b> like <code>@tool</code>, <code>@resource</code>, <code>@prompt</code>), and <code>FastMCP</code> handles the complex cooking process (managing the low-level MCP details) for you.</p>
<p><b>Key benefits of using <code>FastMCP</code>:</b></p>
<ul>
<li><b>Simplicity:</b> Hides a lot of the complex MCP protocol details.</li>
<li><b>Developer-Friendly:</b> Uses familiar Python concepts like functions and decorators.</li>
<li><b>Less Boilerplate:</b> Reduces the amount of repetitive setup code you need to write.</li>
<li><b>Built-in Features:</b> Includes easy ways to manage settings, automatically tell clients what your server can do (capability generation), and handle common tasks.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2363"></a>
Your First <code>FastMCP</code> Server: The Foundation</h2>
<p>Let's start with the absolute minimum needed to create a <code>FastMCP</code> server.</p>
<p><b>File: <code>my_simple_server.py</code></b></p>
<div class="fragment"><div class="line"><span class="comment"># 1. Import the FastMCP class</span></div>
<div class="line"><span class="keyword">from</span> mcp.server.fastmcp <span class="keyword">import</span> FastMCP</div>
<div class="line"> </div>
<div class="line"><span class="comment"># 2. Create an instance of the FastMCP server</span></div>
<div class="line"><span class="comment">#    Give it a name clients might see.</span></div>
<div class="line"><span class="comment">#    Optionally, provide general instructions.</span></div>
<div class="line">server = FastMCP(</div>
<div class="line">    name=<span class="stringliteral">&quot;MySimpleServer&quot;</span>,</div>
<div class="line">    instructions=<span class="stringliteral">&quot;This is a very simple example server.&quot;</span></div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># 3. Add the standard Python block to run the server</span></div>
<div class="line"><span class="comment">#    when the script is executed directly.</span></div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    print(f<span class="stringliteral">&quot;Starting {server.name}...&quot;</span>)</div>
<div class="line">    <span class="comment"># This tells FastMCP to start listening for connections</span></div>
<div class="line">    server.run()</div>
<div class="line">    print(f<span class="stringliteral">&quot;{server.name} finished.&quot;</span>) <span class="comment"># Usually only seen after stopping (Ctrl+C)</span></div>
</div><!-- fragment --><p><b>Explanation:</b></p>
<ol type="1">
<li><b><code>from mcp.server.fastmcp import FastMCP</code></b>: We import the main <code>FastMCP</code> class from the SDK.</li>
<li><b><code>server = FastMCP(...)</code></b>: We create our "multi-cooker" object.<ul>
<li><code>name="MySimpleServer"</code>: This is a human-readable name for your server. Clients might display this name.</li>
<li><code>instructions="..."</code>: This provides a general description or purpose for the server. Clients can use this to understand what the server does.</li>
</ul>
</li>
<li><b><code>if __name__ == "__main__":</code></b>: This is a standard Python pattern. The code inside this block only runs when you execute the script directly (e.g., using <code>python my_simple_server.py</code> or <code>mcp run my_simple_server.py</code>).</li>
<li><b><code>server.run()</code></b>: This is the command that actually starts the server. It tells <code>FastMCP</code> to begin listening for incoming connections and handling MCP messages. By default, it uses the "stdio" transport (reading/writing from the terminal), which we discussed briefly in Chapter 1.</li>
</ol>
<p>If you save this code as <code>my_simple_server.py</code> and run it using <code>mcp run my_simple_server.py</code> (as learned in Chapter 1), it will start! It won't <em>do</em> much yet, because we haven't added any specific capabilities, but it's a functioning MCP server.</p>
<h2><a class="anchor" id="autotoc_md2364"></a>
Adding Features with Decorators: The "Buttons"</h2>
<p>Our multi-cooker (<code>FastMCP</code>) is running, but it doesn't have any cooking programs yet. How do we add features, like our "echo" tool? We use <b>decorators</b>.</p>
<p>Decorators in Python are special markers starting with <code>@</code> that you place above a function definition. They modify or enhance the function in some way. <code>FastMCP</code> uses decorators like <code>@server.tool()</code>, <code>@server.resource()</code>, and <code>@server.prompt()</code> to easily register your Python functions as capabilities that clients can use.</p>
<p>Let's add an "echo" tool using the <code>@server.tool()</code> decorator.</p>
<p><b>File: <code>echo_server.py</code> (Simpler Version)</b></p>
<div class="fragment"><div class="line"><span class="keyword">from</span> mcp.server.fastmcp <span class="keyword">import</span> FastMCP</div>
<div class="line"> </div>
<div class="line"><span class="comment"># 1. Create the server instance</span></div>
<div class="line">server = FastMCP(name=<span class="stringliteral">&quot;EchoServer&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># 2. Define the tool using the @server.tool decorator</span></div>
<div class="line"><span class="preprocessor">@server.tool(name=&quot;echo&quot;, description=&quot;Repeats the input message back.&quot;)</span></div>
<div class="line"><span class="keyword">def </span>echo(message: str) -&gt; str:</div>
<div class="line">  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">  This function is now registered as the &#39;echo&#39; tool.</span></div>
<div class="line"><span class="stringliteral">  &#39;message: str&#39; tells FastMCP the tool expects one argument</span></div>
<div class="line"><span class="stringliteral">  named &#39;message&#39; which should be a string.</span></div>
<div class="line"><span class="stringliteral">  &#39;-&gt; str&#39; tells FastMCP the tool will return a string.</span></div>
<div class="line"><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line">  print(f<span class="stringliteral">&quot;Tool &#39;echo&#39; called with message: {message}&quot;</span>) <span class="comment"># Server-side log</span></div>
<div class="line">  <span class="comment"># 3. The function&#39;s logic directly implements the tool</span></div>
<div class="line">  <span class="keywordflow">return</span> f<span class="stringliteral">&quot;You said: {message}&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># 4. Standard run block</span></div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    print(f<span class="stringliteral">&quot;Starting {server.name}...&quot;</span>)</div>
<div class="line">    server.run() <span class="comment"># Start listening</span></div>
<div class="line">    print(f<span class="stringliteral">&quot;{server.name} finished.&quot;</span>)</div>
</div><!-- fragment --><p><b>Explanation:</b></p>
<ol type="1">
<li><b><code>server = FastMCP(...)</code></b>: Same as before, creates our server object.</li>
<li>**<code>@server.tool(...)</code>**: This is the magic!<ul>
<li>We use the <code>@tool()</code> method of our <code>server</code> object as a decorator.</li>
<li><code>name="echo"</code>: We explicitly tell <code>FastMCP</code> that this tool should be called <code>echo</code> by clients. If we omitted this, it would default to the function name (<code>echo</code>).</li>
<li><code>description="..."</code>: A helpful description for clients.</li>
</ul>
</li>
<li><b><code>def echo(message: str) -&gt; str:</code></b>: This is a standard Python function.<ul>
<li><code>message: str</code>: This is a <b>type hint</b>. It tells <code>FastMCP</code> (and other tools) that this function expects one argument named <code>message</code>, and that argument should be a string. <code>FastMCP</code> uses this information to automatically validate input from clients and generate documentation.</li>
<li><code>-&gt; str</code>: This type hint indicates that the function will return a string. <code>FastMCP</code> uses this to know what kind of output to expect.</li>
<li>The function body contains the logic for our tool.</li>
</ul>
</li>
<li><b><code>server.run()</code></b>: Starts the server, which now knows about the <code>echo</code> tool thanks to the decorator.</li>
</ol>
<p>Now, if you run <code>mcp run echo_server.py</code>, the server will start and will be capable of responding to requests for the <code>echo</code> tool! A client could send a "callTool" request with the name "echo" and an argument <code>{"message": "Hello!"}</code>, and <code>FastMCP</code> would automatically run your <code>echo</code> function and send back the result <code>"You said: Hello!"</code>.</p>
<p>We'll explore <code>@server.resource()</code> and <code>@server.prompt()</code> in later chapters:</p><ul>
<li><a class="el" href="../../d9/dfc/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2MCP_01Python_01SDK_203__fastmcp__resources_95757cc8f176683b04c22ceeac7ea1d5.html">Chapter 3: FastMCP Resources (<code>Resource</code>, <code>ResourceManager</code>)</a></li>
<li><a class="el" href="../../d5/de9/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2MCP_01Python_01SDK_205__fastmcp__prompts___e380d8fca08b641e7632fcc5814680b7.html">Chapter 5: FastMCP Prompts (<code>Prompt</code>, <code>PromptManager</code>)</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md2365"></a>
How <code>FastMCP</code> Works Under the Hood (Simplified)</h2>
<p>It feels simple to use, but what's <code>FastMCP</code> actually doing?</p>
<ol type="1">
<li><b>Initialization:</b> When you create <code>FastMCP()</code>, it sets up internal managers for tools, resources, and prompts (like <code>_tool_manager</code>, <code>_resource_manager</code>, <code>_prompt_manager</code>).</li>
<li><b>Registration:</b> When Python encounters <code>@server.tool(...)</code> above your <code>echo</code> function, it calls the <code>server.tool()</code> method. This method takes your <code>echo</code> function and its details (name, description, parameter types from hints) and registers it with the internal <code>_tool_manager</code>.</li>
<li><b>Running:</b> When you call <code>server.run()</code>, <code>FastMCP</code> starts the underlying low-level MCP server machinery. This machinery listens for incoming connections (e.g., via stdio or web protocols).</li>
<li><b>Handling Requests:</b> When a client connects and sends an MCP message like <code>{"method": "callTool", "params": {"name": "echo", "arguments": {"message": "Test"}}}</code>:<ul>
<li>The low-level server receives the raw message.</li>
<li><code>FastMCP</code>'s core logic takes over. It sees it's a <code>callTool</code> request for the tool named <code>echo</code>.</li>
<li>It asks its <code>_tool_manager</code> if it knows about a tool named <code>echo</code>.</li>
<li>The <code>_tool_manager</code> finds the registered <code>echo</code> function.</li>
<li><code>FastMCP</code> extracts the <code>arguments</code> (<code>{"message": "Test"}</code>) from the request.</li>
<li>It validates these arguments against the function's signature (<code>message: str</code>).</li>
<li>It calls your actual Python <code>echo</code> function, passing <code>"Test"</code> as the <code>message</code> argument.</li>
<li>Your function runs and returns <code>"You said: Test"</code>.</li>
<li><code>FastMCP</code> takes this return value, packages it into a valid MCP <code>callTool</code> response message, and sends it back to the client via the low-level machinery.</li>
</ul>
</li>
</ol>
<p><b>Sequence Diagram:</b></p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant Client</div>
<div class="line">    participant FastMCP_Server as FastMCP (echo_server.py)</div>
<div class="line">    participant ToolManager as _tool_manager</div>
<div class="line">    participant EchoFunction as echo()</div>
<div class="line"> </div>
<div class="line">    Client-&gt;&gt;+FastMCP_Server: Send MCP Request: callTool(name=&quot;echo&quot;, args={&quot;message&quot;: &quot;Test&quot;})</div>
<div class="line">    FastMCP_Server-&gt;&gt;+ToolManager: Find tool named &quot;echo&quot;</div>
<div class="line">    ToolManager--&gt;&gt;-FastMCP_Server: Return registered &#39;echo&#39; function info</div>
<div class="line">    FastMCP_Server-&gt;&gt;+EchoFunction: Call echo(message=&quot;Test&quot;)</div>
<div class="line">    EchoFunction--&gt;&gt;-FastMCP_Server: Return &quot;You said: Test&quot;</div>
<div class="line">    FastMCP_Server-&gt;&gt;-Client: Send MCP Response: result=&quot;You said: Test&quot;</div>
</div><!-- fragment --><p><b>Looking at the Code (Briefly):</b></p>
<p>You don't need to understand every line, but seeing where things happen can be helpful.</p>
<p><b>Inside <code>server/fastmcp/server.py</code> (Simplified <code>FastMCP.__init__</code>):</b></p>
<div class="fragment"><div class="line"><span class="comment"># (...) imports (...)</span></div>
<div class="line"><span class="keyword">from</span> .tools <span class="keyword">import</span> ToolManager</div>
<div class="line"><span class="keyword">from</span> .resources <span class="keyword">import</span> ResourceManager</div>
<div class="line"><span class="keyword">from</span> .prompts <span class="keyword">import</span> PromptManager</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>FastMCP:</div>
<div class="line">    <span class="keyword">def </span>__init__(</div>
<div class="line">        self, name: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>, instructions: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>, **settings: Any</div>
<div class="line">    ):</div>
<div class="line">        <span class="comment"># Stores settings like debug mode, log level etc.</span></div>
<div class="line">        self.settings = Settings(**settings)</div>
<div class="line"> </div>
<div class="line">        <span class="comment"># Creates the underlying low-level MCP server</span></div>
<div class="line">        self._mcp_server = MCPServer(</div>
<div class="line">            name=name <span class="keywordflow">or</span> <span class="stringliteral">&quot;FastMCP&quot;</span>,</div>
<div class="line">            instructions=instructions,</div>
<div class="line">            <span class="comment"># ... other low-level setup ...</span></div>
<div class="line">        )</div>
<div class="line">        <span class="comment"># Creates the managers to keep track of registered items</span></div>
<div class="line">        self._tool_manager = ToolManager(</div>
<div class="line">            warn_on_duplicate_tools=self.settings.warn_on_duplicate_tools</div>
<div class="line">        )</div>
<div class="line">        self._resource_manager = ResourceManager(</div>
<div class="line">            <span class="comment"># ...</span></div>
<div class="line">        )</div>
<div class="line">        self._prompt_manager = PromptManager(</div>
<div class="line">            <span class="comment"># ...</span></div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">        <span class="comment"># Connects MCP requests (like &#39;callTool&#39;) to FastMCP methods</span></div>
<div class="line">        self._setup_handlers()</div>
<div class="line">        <span class="comment"># (...)</span></div>
</div><!-- fragment --><p>This shows that <code>FastMCP</code> creates helper objects (<code>_tool_manager</code>, etc.) to organize the tools, resources, and prompts you register.</p>
<p><b>Inside <code>server/fastmcp/server.py</code> (Simplified <code>FastMCP.tool</code> decorator):</b></p>
<div class="fragment"><div class="line"><span class="comment"># (...) imports (...)</span></div>
<div class="line"><span class="keyword">from</span> mcp.types <span class="keyword">import</span> AnyFunction <span class="comment"># Represents any kind of Python function</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>FastMCP:</div>
<div class="line">    <span class="comment"># (...) other methods (...)</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>tool(</div>
<div class="line">        self, name: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>, description: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line">    ) -&gt; Callable[[AnyFunction], AnyFunction]:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;Decorator to register a tool.&quot;&quot;&quot;</span></div>
<div class="line">        <span class="comment"># (...) error checking (...)</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment"># This is the actual function that gets applied to your &#39;echo&#39; function</span></div>
<div class="line">        <span class="keyword">def </span>decorator(fn: AnyFunction) -&gt; AnyFunction:</div>
<div class="line">            <span class="comment"># Tells the tool manager to remember this function &#39;fn&#39;</span></div>
<div class="line">            <span class="comment"># associating it with the given name and description.</span></div>
<div class="line">            <span class="comment"># It also inspects &#39;fn&#39; to figure out its parameters (like &#39;message: str&#39;)</span></div>
<div class="line">            self.add_tool(fn, name=name, description=description)</div>
<div class="line">            <span class="keywordflow">return</span> fn <span class="comment"># Returns the original function unchanged</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> decorator <span class="comment"># Returns the &#39;decorator&#39; function</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>add_tool(</div>
<div class="line">        self,</div>
<div class="line">        fn: AnyFunction,</div>
<div class="line">        name: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line">        description: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line">    ) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;Add a tool to the server.&quot;&quot;&quot;</span></div>
<div class="line">        <span class="comment"># This passes the function and its info to the ToolManager</span></div>
<div class="line">        self._tool_manager.add_tool(fn, name=name, description=description)</div>
</div><!-- fragment --><p>This shows how the <code>@server.tool()</code> decorator ultimately calls <code>self._tool_manager.add_tool()</code> to register your function.</p>
<p><b>Inside <code>server/fastmcp/server.py</code> (Simplified <code>FastMCP.call_tool</code> handler):</b></p>
<div class="fragment"><div class="line"><span class="comment"># (...) imports (...)</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>FastMCP:</div>
<div class="line">    <span class="comment"># (...) other methods (...)</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">async def </span>call_tool(</div>
<div class="line">        self, name: str, arguments: dict[str, Any]</div>
<div class="line">    ) -&gt; Sequence[TextContent | ImageContent | EmbeddedResource]:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;Call a tool by name with arguments.&quot;&quot;&quot;</span></div>
<div class="line">        <span class="comment"># Gets a &#39;Context&#39; object (more on this later!)</span></div>
<div class="line">        context = self.get_context()</div>
<div class="line">        <span class="comment"># Asks the ToolManager to find and execute the tool</span></div>
<div class="line">        <span class="comment"># The ToolManager handles finding your &#39;echo&#39; function,</span></div>
<div class="line">        <span class="comment"># validating arguments, and calling it.</span></div>
<div class="line">        result = await self._tool_manager.call_tool(name, arguments, context=context)</div>
<div class="line">        <span class="comment"># Converts the function&#39;s return value (e.g., &quot;You said: Test&quot;)</span></div>
<div class="line">        <span class="comment"># into the format MCP expects for the response.</span></div>
<div class="line">        converted_result = _convert_to_content(result)</div>
<div class="line">        <span class="keywordflow">return</span> converted_result</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>_setup_handlers(self) -&gt; None:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;Set up core MCP protocol handlers.&quot;&quot;&quot;</span></div>
<div class="line">        <span class="comment"># This line connects the low-level &#39;callTool&#39; message</span></div>
<div class="line">        <span class="comment"># to the &#39;self.call_tool&#39; method shown above.</span></div>
<div class="line">        self._mcp_server.call_tool()(self.call_tool)</div>
<div class="line">        <span class="comment"># (...) other handlers for listTools, readResource etc. (...)</span></div>
</div><!-- fragment --><p>This shows how an incoming <code>callTool</code> message gets routed to the <code>call_tool</code> method, which then uses the <code>_tool_manager</code> to run your registered function.</p>
<h2><a class="anchor" id="autotoc_md2366"></a>
Conclusion</h2>
<p>You've now seen how <code>FastMCP</code> provides a much simpler way to build MCP servers compared to handling the low-level protocol directly. Like a multi-cooker, it offers convenient "buttons" (decorators like <code>@server.tool()</code>) to add features (like tools) to your server using standard Python functions. It handles the underlying complexity of receiving requests, calling your code, and sending responses.</p>
<p>You learned how to:</p><ul>
<li>Create a basic <code>FastMCP</code> server instance.</li>
<li>Define a Python function that performs a task.</li>
<li>Use the <code>@server.tool()</code> decorator to register that function as a tool clients can call.</li>
<li>Understand the basic flow of how <code>FastMCP</code> handles a tool call request using its internal managers.</li>
</ul>
<p>While our <code>echo</code> tool was simple, <code>FastMCP</code> provides the foundation for building much more complex and powerful AI agents and tools.</p>
<p>In the next chapters, we'll explore the other "buttons" on our multi-cooker, starting with how to provide data and files using <code>@server.resource()</code> in <a class="el" href="../../d9/dfc/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2MCP_01Python_01SDK_203__fastmcp__resources_95757cc8f176683b04c22ceeac7ea1d5.html">Chapter 3: FastMCP Resources (<code>Resource</code>, <code>ResourceManager</code>)</a>.</p>
<hr  />
<p>Generated by <a href="https://github.com/The-Pocket/Tutorial-Codebase-Knowledge">AI Codebase Knowledge Builder</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
