#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ResilientDB: 07_data_structures__views_</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dc/db2/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_207__data__structures____views__.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">07_data_structures__views_</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md925"></a>
autotoc_md925</h2>
<p>layout: default title: "Data Structures (Views)" parent: "Browser Use" </p>
<h2><a class="anchor" id="autotoc_md926"></a>
nav_order: 7</h2>
<h1><a class="anchor" id="autotoc_md927"></a>
Chapter 7: Data Structures (Views) - The Project's Blueprints</h1>
<p>In the <a class="el" href="../../db/dee/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_206__message__manager.html">previous chapter</a>, we saw how the <code>MessageManager</code> acts like a secretary, carefully organizing the conversation between the <a class="el" href="../../de/d8f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_201__agent.html">Agent</a> and the LLM. It manages different pieces of information – the browser's current state, the LLM's plan, the results of actions, and more.</p>
<p>But how do all these different components – the Agent, the LLM parser, the <a class="el" href="../../dd/da5/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_203__browsercontext.html">BrowserContext</a>, the <a class="el" href="../../de/dc1/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_205__action__controller______registry.html">Action Controller &amp; Registry</a>, and the <a class="el" href="../../db/dee/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_206__message__manager.html">Message Manager</a> – ensure they understand each other perfectly? If the LLM gives a plan in one format, and the Controller expects it in another, things will break!</p>
<p>Imagine trying to build furniture using instructions written in a language you don't fully understand, or trying to fill out a form where every section uses a different layout. It would be confusing and error-prone. We need a shared, consistent language and format.</p>
<p>This is where <b>Data Structures (Views)</b> come in. They act as the official blueprints or standardized forms for all the important information passed around within the <code>Browser Use</code> project.</p>
<h2><a class="anchor" id="autotoc_md928"></a>
What Problem Do Data Structures Solve?</h2>
<p>In a complex system like <code>Browser Use</code>, many components need to exchange data:</p>
<ul>
<li>The <a class="el" href="../../dd/da5/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_203__browsercontext.html">BrowserContext</a> needs to package up the current state of the webpage.</li>
<li>The <a class="el" href="../../de/d8f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_201__agent.html">Agent</a> needs to understand the LLM's multi-step plan.</li>
<li>The <a class="el" href="../../de/dc1/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_205__action__controller______registry.html">Action Controller &amp; Registry</a> needs to know exactly which action to perform and with what specific parameters (like which element index to click).</li>
<li>The Controller needs to report back the result of an action in a predictable way.</li>
</ul>
<p>Without a standard format for each piece of data, you might encounter problems like:</p>
<ul>
<li>Misinterpreting data (e.g., is <code>5</code> an element index or a quantity?).</li>
<li>Missing required information.</li>
<li>Inconsistent naming (<code>element_id</code> vs <code>index</code> vs <code>element_number</code>).</li>
<li>Difficulty debugging when data looks different every time.</li>
</ul>
<p>Data Structures (Views) solve this by defining <b>strict, consistent blueprints</b> for the data. Everyone agrees to use these blueprints, ensuring smooth communication and preventing errors.</p>
<h2><a class="anchor" id="autotoc_md929"></a>
Meet Pydantic: The Blueprint Maker and Checker</h2>
<p>In <code>Browser Use</code>, these blueprints are primarily defined using a popular Python library called <b>Pydantic</b>.</p>
<p>Think of Pydantic like a combination of:</p>
<ol type="1">
<li><b>A Blueprint Designer:</b> It provides an easy way to define the structure of your data using standard Python type hints (like <code>str</code> for text, <code>int</code> for whole numbers, <code>bool</code> for True/False, <code>list</code> for lists).</li>
<li><b>A Quality Inspector:</b> When data comes in (e.g., from the LLM or from an action's result), Pydantic automatically checks if it matches the blueprint. Does it have all the required fields? Are the data types correct? If not, Pydantic raises an error, stopping bad data before it causes problems later.</li>
</ol>
<p>These Pydantic models (our blueprints) are often stored in files named <code>views.py</code> within different component directories (like <code>agent/views.py</code>, <code>browser/views.py</code>), which is why we sometimes call them "Views".</p>
<h2><a class="anchor" id="autotoc_md930"></a>
Key Blueprints in <code>Browser Use</code></h2>
<p>Let's look at some of the most important data structures used in the project. Don't worry about memorizing every detail; focus on <em>what kind</em> of information each blueprint holds and <em>who</em> uses it.</p>
<p><em>(Note: These are simplified representations. The actual models might have more fields or features.)</em></p>
<h3><a class="anchor" id="autotoc_md931"></a>
1. <code>BrowserState</code> (from <code>browser/views.py</code>)</h3>
<ul>
<li><b>Purpose:</b> Represents a complete snapshot of the browser's state at a specific moment.</li>
<li><b>Blueprint Contents (Simplified):</b><ul>
<li><code>url</code>: The current web address (string).</li>
<li><code>title</code>: The title of the webpage (string).</li>
<li><code>element_tree</code>: The simplified map of the webpage content (from <a class="el" href="../../d0/df8/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_204__dom__representation.html">DOM Representation</a>).</li>
<li><code>selector_map</code>: The lookup map for interactive elements (from <a class="el" href="../../d0/df8/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_204__dom__representation.html">DOM Representation</a>).</li>
<li><code>screenshot</code>: An optional image of the page (string, base64 encoded).</li>
<li><code>tabs</code>: Information about other open tabs in this context (list).</li>
</ul>
</li>
<li><b>Who Uses It:</b><ul>
<li>Created by: <a class="el" href="../../dd/da5/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_203__browsercontext.html">BrowserContext</a> (<code>get_state()</code> method).</li>
<li>Used by: <a class="el" href="../../de/d8f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_201__agent.html">Agent</a> (to see the current situation), <a class="el" href="../../db/dee/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_206__message__manager.html">Message Manager</a> (to store in history).</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="comment"># --- Conceptual Pydantic Model ---</span></div>
<div class="line"><span class="comment"># File: browser/views.py (Simplified Example)</span></div>
<div class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel</div>
<div class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Optional, List, Dict <span class="comment"># For type hints</span></div>
<div class="line"><span class="comment"># Assume DOMElementNode and TabInfo are defined elsewhere</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>BrowserState(BaseModel):</div>
<div class="line">    url: str</div>
<div class="line">    title: str</div>
<div class="line">    element_tree: Optional[object] <span class="comment"># Simplified: Actual type is DOMElementNode</span></div>
<div class="line">    selector_map: Optional[Dict[int, object]] <span class="comment"># Simplified: Actual type is SelectorMap</span></div>
<div class="line">    screenshot: Optional[str] = <span class="keywordtype">None</span> <span class="comment"># Optional field</span></div>
<div class="line">    tabs: List[object] = [] <span class="comment"># Simplified: Actual type is TabInfo</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Pydantic ensures that when a BrowserState is created,</span></div>
<div class="line"><span class="comment"># &#39;url&#39; and &#39;title&#39; MUST be provided as strings.</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md932"></a>
2. <code>ActionModel</code> (from <code>controller/registry/views.py</code>)</h3>
<ul>
<li><b>Purpose:</b> Represents a <em>single</em> specific action the LLM wants to perform, including its parameters. This model is often created <em>dynamically</em> based on the actions available in the <a class="el" href="../../de/dc1/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_205__action__controller______registry.html">Action Controller &amp; Registry</a>.</li>
<li><b>Blueprint Contents (Example for <code>click_element</code>):</b><ul>
<li><code>index</code>: The <code>highlight_index</code> of the element to click (integer).</li>
<li><code>xpath</code>: An optional hint about the element's location (string).</li>
</ul>
</li>
<li><b>Blueprint Contents (Example for <code>input_text</code>):</b><ul>
<li><code>index</code>: The <code>highlight_index</code> of the input field (integer).</li>
<li><code>text</code>: The text to type (string).</li>
</ul>
</li>
<li><b>Who Uses It:</b><ul>
<li>Defined by/Registered in: <a class="el" href="../../de/dc1/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_205__action__controller______registry.html">Action Controller &amp; Registry</a>.</li>
<li>Created based on: LLM output (often part of <code>AgentOutput</code>).</li>
<li>Used by: <a class="el" href="../../de/dc1/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_205__action__controller______registry.html">Action Controller &amp; Registry</a> (to validate parameters and know what function to call).</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="comment"># --- Conceptual Pydantic Models ---</span></div>
<div class="line"><span class="comment"># File: controller/views.py (Simplified Examples)</span></div>
<div class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel</div>
<div class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Optional</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ClickElementAction(BaseModel):</div>
<div class="line">    index: int</div>
<div class="line">    xpath: Optional[str] = <span class="keywordtype">None</span> <span class="comment"># Optional hint</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>InputTextAction(BaseModel):</div>
<div class="line">    index: int</div>
<div class="line">    text: str</div>
<div class="line">    xpath: Optional[str] = <span class="keywordtype">None</span> <span class="comment"># Optional hint</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Base model that dynamically holds ONE of the above actions</span></div>
<div class="line"><span class="keyword">class </span>ActionModel(BaseModel):</div>
<div class="line">    <span class="comment"># Pydantic allows models like this where only one field is expected</span></div>
<div class="line">    <span class="comment"># e.g., ActionModel(click_element=ClickElementAction(index=5))</span></div>
<div class="line">    <span class="comment"># or    ActionModel(input_text=InputTextAction(index=12, text=&quot;hello&quot;))</span></div>
<div class="line">    click_element: Optional[ClickElementAction] = <span class="keywordtype">None</span></div>
<div class="line">    input_text: Optional[InputTextAction] = <span class="keywordtype">None</span></div>
<div class="line">    <span class="comment"># ... fields for other possible actions (scroll, done, etc.) ...</span></div>
<div class="line">    <span class="keywordflow">pass</span> <span class="comment"># More complex logic handles ensuring only one action is present</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md933"></a>
3. <code>AgentOutput</code> (from <code>agent/views.py</code>)</h3>
<ul>
<li><b>Purpose:</b> Represents the complete plan received from the LLM after it analyzes the current state. This is the structure the <a class="el" href="../../dd/d81/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_202__system__prompt.html">System Prompt</a> tells the LLM to follow.</li>
<li><b>Blueprint Contents (Simplified):</b><ul>
<li><code>current_state</code>: The LLM's thoughts/reasoning (a nested structure, often called <code>AgentBrain</code>).</li>
<li><code>action</code>: A <em>list</em> of one or more <code>ActionModel</code> objects representing the steps the LLM wants to take.</li>
</ul>
</li>
<li><b>Who Uses It:</b><ul>
<li>Created by: The <a class="el" href="../../de/d8f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_201__agent.html">Agent</a> parses the LLM's raw JSON output into this structure.</li>
<li>Used by: <a class="el" href="../../de/d8f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_201__agent.html">Agent</a> (to understand the plan), <a class="el" href="../../db/dee/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_206__message__manager.html">Message Manager</a> (to store the plan in history), <a class="el" href="../../de/dc1/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_205__action__controller______registry.html">Action Controller &amp; Registry</a> (reads the <code>action</code> list).</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="comment"># --- Conceptual Pydantic Model ---</span></div>
<div class="line"><span class="comment"># File: agent/views.py (Simplified Example)</span></div>
<div class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel</div>
<div class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</div>
<div class="line"><span class="comment"># Assume ActionModel and AgentBrain are defined elsewhere</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>AgentOutput(BaseModel):</div>
<div class="line">    current_state: object <span class="comment"># Simplified: Actual type is AgentBrain</span></div>
<div class="line">    action: List[ActionModel] <span class="comment"># A list of actions to execute</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Pydantic ensures the LLM output MUST have &#39;current_state&#39; and &#39;action&#39;,</span></div>
<div class="line"><span class="comment"># and that &#39;action&#39; MUST be a list containing valid ActionModel objects.</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md934"></a>
4. <code>ActionResult</code> (from <code>agent/views.py</code>)</h3>
<ul>
<li><b>Purpose:</b> Represents the outcome after the <a class="el" href="../../de/dc1/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_205__action__controller______registry.html">Action Controller &amp; Registry</a> attempts to execute a single action.</li>
<li><b>Blueprint Contents (Simplified):</b><ul>
<li><code>is_done</code>: Did this action signal the end of the overall task? (boolean, optional).</li>
<li><code>success</code>: If done, was the task successful overall? (boolean, optional).</li>
<li><code>extracted_content</code>: Any text result from the action (e.g., "Clicked button X") (string, optional).</li>
<li><code>error</code>: Any error message if the action failed (string, optional).</li>
<li><code>include_in_memory</code>: Should this result be explicitly shown to the LLM next time? (boolean).</li>
</ul>
</li>
<li><b>Who Uses It:</b><ul>
<li>Created by: Functions within the <a class="el" href="../../de/dc1/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_205__action__controller______registry.html">Action Controller &amp; Registry</a> (like <code>click_element</code>).</li>
<li>Used by: <a class="el" href="../../de/d8f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_201__agent.html">Agent</a> (to check status, record results), <a class="el" href="../../db/dee/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_206__message__manager.html">Message Manager</a> (includes info in the next state message sent to LLM).</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="comment"># --- Conceptual Pydantic Model ---</span></div>
<div class="line"><span class="comment"># File: agent/views.py (Simplified Example)</span></div>
<div class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel</div>
<div class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Optional</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ActionResult(BaseModel):</div>
<div class="line">    is_done: Optional[bool] = <span class="keyword">False</span></div>
<div class="line">    success: Optional[bool] = <span class="keywordtype">None</span></div>
<div class="line">    extracted_content: Optional[str] = <span class="keywordtype">None</span></div>
<div class="line">    error: Optional[str] = <span class="keywordtype">None</span></div>
<div class="line">    include_in_memory: bool = <span class="keyword">False</span> <span class="comment"># Default to False</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Pydantic helps ensure results are consistently structured.</span></div>
<div class="line"><span class="comment"># For example, &#39;is_done&#39; must be True or False if provided.</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md935"></a>
The Power of Blueprints: Ensuring Consistency</h2>
<p>Using Pydantic models for these data structures provides a huge benefit: <b>automatic validation</b>.</p>
<p>Imagine the LLM sends back a plan, but it forgets to include the <code>index</code> for a <code>click_element</code> action.</p>
<div class="fragment"><div class="line">// Bad LLM Response (Missing &#39;index&#39;)</div>
<div class="line">{</div>
<div class="line">  &quot;current_state&quot;: { ... },</div>
<div class="line">  &quot;action&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;click_element&quot;: {</div>
<div class="line">         &quot;xpath&quot;: &quot;//button[@id=&#39;submit&#39;]&quot; // &#39;index&#39; is missing!</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>When the <a class="el" href="../../de/d8f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_201__agent.html">Agent</a> tries to parse this JSON into the <code>AgentOutput</code> Pydantic model, Pydantic will immediately notice that the <code>index</code> field (which is required by the <code>ClickElementAction</code> blueprint) is missing. It will raise a <code>ValidationError</code>.</p>
<div class="fragment"><div class="line"><span class="comment"># --- Conceptual Agent Code ---</span></div>
<div class="line"><span class="keyword">import</span> pydantic</div>
<div class="line"><span class="comment"># Assume AgentOutput is the Pydantic model defined earlier</span></div>
<div class="line"><span class="comment"># Assume &#39;llm_json_response&#39; contains the bad JSON from above</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">try</span>:</div>
<div class="line">    <span class="comment"># Try to create the AgentOutput object from the LLM&#39;s response</span></div>
<div class="line">    llm_plan = AgentOutput.model_validate_json(llm_json_response)</div>
<div class="line">    <span class="comment"># If validation succeeds, proceed...</span></div>
<div class="line">    print(<span class="stringliteral">&quot;LLM Plan Validated:&quot;</span>, llm_plan)</div>
<div class="line"><span class="keywordflow">except</span> pydantic.ValidationError <span class="keyword">as</span> e:</div>
<div class="line">    <span class="comment"># Pydantic catches the error!</span></div>
<div class="line">    print(f<span class="stringliteral">&quot;Validation Error: The LLM response didn&#39;t match the blueprint!&quot;</span>)</div>
<div class="line">    print(e)</div>
<div class="line">    <span class="comment"># The Agent can now handle this error gracefully,</span></div>
<div class="line">    <span class="comment"># maybe asking the LLM to try again, instead of crashing later.</span></div>
</div><!-- fragment --><p>This automatic checking catches errors early, preventing the <a class="el" href="../../de/dc1/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_205__action__controller______registry.html">Action Controller &amp; Registry</a> from receiving incomplete instructions and making the whole system much more robust and easier to debug. It enforces the "contract" between different components.</p>
<h2><a class="anchor" id="autotoc_md936"></a>
Under the Hood: Simple Classes</h2>
<p>These data structures are simply Python classes, mostly inheriting from <code>pydantic.BaseModel</code> or defined using Python's built-in <code>dataclass</code>. They don't contain complex logic themselves; their main job is to define the <em>shape</em> and <em>type</em> of the data. You'll find their definitions scattered across the various <code>views.py</code> files within the project's component directories (like <code>agent/</code>, <code>browser/</code>, <code>controller/</code>, <code>dom/</code>).</p>
<p>Think of them as the official vocabulary and grammar rules that all the components agree to use when communicating.</p>
<h2><a class="anchor" id="autotoc_md937"></a>
Conclusion</h2>
<p>Data Structures (Views), primarily defined using Pydantic models, are the essential blueprints that ensure consistent and reliable communication within the <code>Browser Use</code> project. They act like standardized forms for <code>BrowserState</code>, <code>AgentOutput</code>, <code>ActionModel</code>, and <code>ActionResult</code>, making sure every component knows exactly what kind of data to expect and how to interpret it.</p>
<p>By defining these clear structures and leveraging Pydantic's automatic validation, <code>Browser Use</code> prevents misunderstandings between components, catches errors early, and makes the overall system more robust and maintainable. These standardized structures also make it easier to log and understand what's happening in the system.</p>
<p>Speaking of logging and understanding the system's behavior, how can we monitor the Agent's performance and gather data for improvement? In the next and final chapter, we'll explore the <a class="el" href="../../d6/d41/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_208__telemetry__service.html">Telemetry Service</a>.</p>
<p><a class="el" href="../../d6/d41/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2Browser_01Use_208__telemetry__service.html">Next Chapter: Telemetry Service</a></p>
<hr  />
<p>Generated by <a href="https://github.com/The-Pocket/Tutorial-Codebase-Knowledge">AI Codebase Knowledge Builder</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
