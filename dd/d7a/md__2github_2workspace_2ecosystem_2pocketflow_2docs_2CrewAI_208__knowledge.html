#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ResilientDB: 08_knowledge</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dd/d7a/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_208__knowledge.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">08_knowledge</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md1576"></a>
autotoc_md1576</h2>
<p>layout: default title: "Knowledge" parent: "CrewAI" </p>
<h2><a class="anchor" id="autotoc_md1577"></a>
nav_order: 8</h2>
<h1><a class="anchor" id="autotoc_md1578"></a>
Chapter 8: Knowledge - Providing External Information</h1>
<p>In <a class="el" href="../../db/de6/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_207__memory.html">Chapter 7: Memory</a>, we learned how to give our <a class="el" href="../../d4/d90/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_201__crew.html">Crew</a> the ability to remember past interactions and details using <code>Memory</code>. This helps them maintain context within a single run and potentially across runs.</p>
<p>But what if your <a class="el" href="../../d2/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_202__agent.html">Agent</a> needs access to a large body of <em>existing</em> information that isn't derived from its own conversations? Think about company documents, technical manuals, specific research papers, or a product catalog. This information exists <em>before</em> the Crew starts working. How do we give our agents access to this specific library of information?</p>
<p>That's where <b><code>Knowledge</code></b> comes in!</p>
<h2><a class="anchor" id="autotoc_md1579"></a>
Why Do We Need Knowledge?</h2>
<p>Imagine you have an <a class="el" href="../../d2/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_202__agent.html">Agent</a> whose job is to answer customer questions about a specific product, "Widget Pro". You want this agent to <em>only</em> use the official "Widget Pro User Manual" to answer questions, not its general knowledge from the internet (which might be outdated or wrong).</p>
<p>Without a way to provide the manual, the agent might hallucinate answers or use incorrect information. <code>Knowledge</code> allows us to load specific documents (like the user manual), process them, and make them searchable for our agents.</p>
<p><b>Problem Solved:</b> <code>Knowledge</code> provides your <a class="el" href="../../d2/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_202__agent.html">Agent</a>s with access to specific, pre-defined external information sources (like documents or databases), allowing them to retrieve relevant context to enhance their understanding and task execution based on that specific information.</p>
<h2><a class="anchor" id="autotoc_md1580"></a>
What is Knowledge?</h2>
<p>Think of <code>Knowledge</code> as giving your <a class="el" href="../../d4/d90/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_201__crew.html">Crew</a> access to a <b>specialized, private library</b> full of specific documents or information. It consists of a few key parts:</p>
<ol type="1">
<li><b><code>KnowledgeSource</code></b>: This represents the actual <em>source</em> of the information. It could be:<ul>
<li>A local file (PDF, DOCX, TXT, etc.)</li>
<li>A website URL</li>
<li>A database connection (more advanced) CrewAI uses helpful classes like <code>CrewDoclingSource</code> to easily handle various file types and web content. You tell the <code>KnowledgeSource</code> <em>where</em> the information is (e.g., the file path to your user manual).</li>
</ul>
</li>
<li><b>Processing &amp; Embedding</b>: When you create a <code>Knowledge</code> object with sources, the information is automatically:<ul>
<li><b>Loaded</b>: The content is read from the source (e.g., text extracted from the PDF).</li>
<li><b>Chunked</b>: The long text is broken down into smaller, manageable pieces (chunks).</li>
<li><b>Embedded</b>: Each chunk is converted into a numerical representation (an embedding vector) that captures its meaning. This is done using an embedding model (often specified via the <code>embedder</code> configuration).</li>
</ul>
</li>
<li><b><code>KnowledgeStorage</code> (Vector Database)</b>: These embedded chunks are then stored in a special kind of database called a vector database. CrewAI typically uses <b>ChromaDB</b> by default for this.<ul>
<li><b>Why?</b> Vector databases are optimized for finding information based on <em>semantic similarity</em>. When an agent asks a question related to a topic, the database can quickly find the text chunks whose meanings (embeddings) are closest to the meaning of the question.</li>
</ul>
</li>
<li><b>Retrieval</b>: When an <a class="el" href="../../d2/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_202__agent.html">Agent</a> needs information for its <a class="el" href="../../d1/dae/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_203__task.html">Task</a>, it queries the <code>Knowledge</code> object. This query is also embedded, and the <code>KnowledgeStorage</code> efficiently retrieves the most relevant text chunks from the original documents. These chunks are then provided to the agent as context.</li>
</ol>
<p>In short: <code>Knowledge</code> = Specific Info Sources + Processing/Embedding + Vector Storage + Retrieval.</p>
<h2><a class="anchor" id="autotoc_md1581"></a>
Using Knowledge in Your Crew</h2>
<p>Let's give our 'Product Support Agent' access to a hypothetical "widget_pro_manual.txt" file.</p>
<p><b>1. Prepare Your Knowledge Source File:</b></p>
<p>Make sure you have a directory named <code>knowledge</code> in your project's root folder. Place your file (e.g., <code>widget_pro_manual.txt</code>) inside this directory.</p>
<div class="fragment"><div class="line">your_project_root/</div>
<div class="line">├── knowledge/</div>
<div class="line">│   └── widget_pro_manual.txt</div>
<div class="line">└── your_crewai_script.py</div>
</div><!-- fragment --><p><em>(Make sure <code>widget_pro_manual.txt</code> contains some text about Widget Pro.)</em></p>
<p><b>2. Define the Knowledge Source and Knowledge Object:</b></p>
<div class="fragment"><div class="line"><span class="comment"># Make sure you have docling installed for file handling: pip install docling</span></div>
<div class="line"><span class="keyword">from</span> crewai <span class="keyword">import</span> Agent, Task, Crew, Process, Knowledge</div>
<div class="line"><span class="keyword">from</span> crewai.knowledge.source.crew_docling_source <span class="keyword">import</span> CrewDoclingSource</div>
<div class="line"><span class="comment"># Assume an LLM is configured (e.g., via environment variables or passed to Agent/Crew)</span></div>
<div class="line"><span class="comment"># from langchain_openai import ChatOpenAI</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Define the knowledge source - point to the file inside the &#39;knowledge&#39; directory</span></div>
<div class="line"><span class="comment"># Use the relative path from within the &#39;knowledge&#39; directory</span></div>
<div class="line">manual_source = CrewDoclingSource(file_paths=[<span class="stringliteral">&quot;widget_pro_manual.txt&quot;</span>])</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create the Knowledge object, give it a name and pass the sources</span></div>
<div class="line"><span class="comment"># This will load, chunk, embed, and store the manual&#39;s content</span></div>
<div class="line">product_knowledge = Knowledge(</div>
<div class="line">    collection_name=<span class="stringliteral">&quot;widget_pro_manual&quot;</span>, <span class="comment"># Name for the storage collection</span></div>
<div class="line">    sources=[manual_source],</div>
<div class="line">    <span class="comment"># embedder=... # Optional: specify embedding config, otherwise uses default</span></div>
<div class="line">    <span class="comment"># storage=... # Optional: specify storage config, otherwise uses default ChromaDB</span></div>
<div class="line">)</div>
</div><!-- fragment --><p><b>Explanation:</b></p>
<ul>
<li>We import <code>Knowledge</code> and <code>CrewDoclingSource</code>.</li>
<li><code>CrewDoclingSource(file_paths=["widget_pro_manual.txt"])</code>: We create a source pointing to our file. Note: The path is relative <em>within</em> the <code>knowledge</code> directory. <code>CrewDoclingSource</code> handles loading various file types.</li>
<li><code>Knowledge(collection_name="widget_pro_manual", sources=[manual_source])</code>: We create the main <code>Knowledge</code> object.<ul>
<li><code>collection_name</code>: A unique name for this set of knowledge in the vector database.</li>
<li><code>sources</code>: A list containing the <code>manual_source</code> we defined.</li>
<li>When this line runs, CrewAI automatically processes <code>widget_pro_manual.txt</code> and stores it in the vector database under the collection "widget\_pro\_manual".</li>
</ul>
</li>
</ul>
<p><b>3. Equip an Agent with Knowledge:</b></p>
<p>You can add the <code>Knowledge</code> object directly to an agent.</p>
<div class="fragment"><div class="line"><span class="comment"># Define the agent and give it the knowledge base</span></div>
<div class="line">support_agent = Agent(</div>
<div class="line">    role=<span class="stringliteral">&#39;Product Support Specialist&#39;</span>,</div>
<div class="line">    goal=<span class="stringliteral">&#39;Answer customer questions accurately based ONLY on the Widget Pro manual.&#39;</span>,</div>
<div class="line">    backstory=<span class="stringliteral">&#39;You are an expert support agent with deep knowledge of the Widget Pro, derived exclusively from its official manual.&#39;</span>,</div>
<div class="line">    knowledge=product_knowledge, <span class="comment"># &lt;-- Assign the knowledge here!</span></div>
<div class="line">    verbose=<span class="keyword">True</span>,</div>
<div class="line">    allow_delegation=<span class="keyword">False</span>,</div>
<div class="line">    <span class="comment"># llm=ChatOpenAI(model=&quot;gpt-4&quot;) # Example LLM</span></div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Define a task for the agent</span></div>
<div class="line">support_task = Task(</div>
<div class="line">    description=<span class="stringliteral">&quot;The customer asks: &#39;How do I reset my Widget Pro?&#39; Use the manual to find the answer.&quot;</span>,</div>
<div class="line">    expected_output=<span class="stringliteral">&quot;A clear, step-by-step answer based solely on the provided manual content.&quot;</span>,</div>
<div class="line">    agent=support_agent</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create and run the crew</span></div>
<div class="line">support_crew = Crew(</div>
<div class="line">    agents=[support_agent],</div>
<div class="line">    tasks=[support_task],</div>
<div class="line">    process=Process.sequential</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># result = support_crew.kickoff()</span></div>
<div class="line"><span class="comment"># print(result)</span></div>
</div><!-- fragment --><p><b>Explanation:</b></p>
<ul>
<li>When defining <code>support_agent</code>, we pass our <code>product_knowledge</code> object to the <code>knowledge</code> parameter: <code>knowledge=product_knowledge</code>.</li>
<li>Now, whenever <code>support_agent</code> works on a <code>Task</code>, it will automatically query the <code>product_knowledge</code> base for relevant information <em>before</em> calling its <a class="el" href="../../da/d0f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_206__llm.html">LLM</a>.</li>
<li>The retrieved text chunks from <code>widget_pro_manual.txt</code> will be added to the context given to the <a class="el" href="../../da/d0f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_206__llm.html">LLM</a>, strongly guiding it to answer based on the manual.</li>
</ul>
<p><b>Expected Outcome (Conceptual):</b></p>
<p>When <code>support_crew.kickoff()</code> runs:</p>
<ol type="1">
<li><code>support_agent</code> receives <code>support_task</code>.</li>
<li>The agent (internally) queries <code>product_knowledge</code> with something like "How do I reset my Widget Pro?".</li>
<li>The vector database finds chunks from <code>widget_pro_manual.txt</code> that are semantically similar (e.g., sections describing the reset procedure).</li>
<li>These relevant text chunks are retrieved.</li>
<li>The agent's <a class="el" href="../../da/d0f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_206__llm.html">LLM</a> receives the task description <em>plus</em> the retrieved manual excerpts as context.</li>
<li>The <a class="el" href="../../da/d0f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_206__llm.html">LLM</a> generates the answer based heavily on the provided manual text.</li>
<li>The final <code>result</code> will be the step-by-step reset instructions derived from the manual.</li>
</ol>
<p><em>(Alternatively, you can assign <code>Knowledge</code> at the <code>Crew</code> level using the <code>knowledge</code> parameter, making it available to all agents in the crew.)</em></p>
<h2><a class="anchor" id="autotoc_md1582"></a>
How Knowledge Retrieval Works Internally</h2>
<p>When an <a class="el" href="../../d2/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_202__agent.html">Agent</a> with assigned <code>Knowledge</code> executes a <a class="el" href="../../d1/dae/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_203__task.html">Task</a>:</p>
<ol type="1">
<li><b>Task Start:</b> The agent begins processing the task.</li>
<li><b>Context Building:</b> The agent prepares the information needed for its <a class="el" href="../../da/d0f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_206__llm.html">LLM</a>. This includes the task description, its role/goal/backstory, and any context from <code>Memory</code> (if enabled).</li>
<li><b>Knowledge Query:</b> The agent identifies the need for information related to the task. It formulates a query (often based on the task description or key terms) and sends it to its assigned <code>Knowledge</code> object.</li>
<li><b>Storage Search:</b> The <code>Knowledge</code> object passes the query to its underlying <code>KnowledgeStorage</code> (the vector database, e.g., ChromaDB).</li>
<li><b>Vector Similarity Search:</b> The vector database converts the query into an embedding and searches for stored text chunks whose embeddings are closest (most similar) to the query embedding.</li>
<li><b>Retrieve Chunks:</b> The database returns the top N most relevant text chunks (along with metadata and scores).</li>
<li><b>Augment Prompt:</b> The agent takes these retrieved text chunks and adds them as specific context to the prompt it's preparing for the <a class="el" href="../../da/d0f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_206__llm.html">LLM</a>. The prompt might now look something like: "Your task is: [...task description...]. Here is relevant information from the knowledge base: [...retrieved chunk 1...] [...retrieved chunk 2...] Now, provide the final answer."</li>
<li><b>LLM Call:</b> The agent sends this augmented prompt to its <a class="el" href="../../da/d0f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_206__llm.html">LLM</a>.</li>
<li><b>Generate Response:</b> The <a class="el" href="../../da/d0f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_206__llm.html">LLM</a>, now equipped with highly relevant context directly from the specified knowledge source, generates a more accurate and grounded response.</li>
</ol>
<p>Let's visualize this retrieval process:</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant A as Agent</div>
<div class="line">    participant K as Knowledge Object</div>
<div class="line">    participant KS as KnowledgeStorage (Vector DB)</div>
<div class="line">    participant LLM as Agent&#39;s LLM</div>
<div class="line"> </div>
<div class="line">    A-&gt;&gt;A: Start Task (&#39;How to reset Widget Pro?&#39;)</div>
<div class="line">    A-&gt;&gt;A: Prepare base prompt (Task, Role, Goal...)</div>
<div class="line">    A-&gt;&gt;K: Query(&#39;How to reset Widget Pro?&#39;)</div>
<div class="line">    K-&gt;&gt;KS: Search(query=&#39;How to reset Widget Pro?&#39;)</div>
<div class="line">    Note right of KS: Finds similar chunks via embeddings</div>
<div class="line">    KS--&gt;&gt;K: Return relevant chunks from manual</div>
<div class="line">    K--&gt;&gt;A: Provide relevant chunks</div>
<div class="line">    A-&gt;&gt;A: Augment prompt with retrieved chunks</div>
<div class="line">    A-&gt;&gt;LLM: Send augmented prompt</div>
<div class="line">    LLM--&gt;&gt;A: Generate answer based on task + manual excerpts</div>
<div class="line">    A-&gt;&gt;A: Final Answer (Steps from manual)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1583"></a>
Diving into the Code (High Level)</h2>
<ul>
<li><p class="startli"><b><code>crewai/knowledge/knowledge.py</code></b>:</p><ul>
<li>The <code>Knowledge</code> class holds the list of <code>sources</code> and the <code>storage</code> object.</li>
<li>Its <code>__init__</code> method initializes the <code>KnowledgeStorage</code> (creating a default ChromaDB instance if none is provided) and then iterates through the <code>sources</code>, telling each one to <code>add()</code> its content to the storage.</li>
<li>The <code>query()</code> method simply delegates the search request to the <code>self.storage.search()</code> method.</li>
</ul>
<p class="startli">```python </p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md1584"></a>
Simplified view from crewai/knowledge/knowledge.py</h1>
<p>class Knowledge(BaseModel): sources: List[BaseKnowledgeSource] = Field(default_factory=list) storage: Optional[KnowledgeStorage] = Field(default=None) embedder: Optional[Dict[str, Any]] = None collection_name: Optional[str] = None</p>
<p>def <b>init</b>(self, collection_name: str, sources: List[BaseKnowledgeSource], ...): </p>
<h1><a class="anchor" id="autotoc_md1585"></a>
... setup storage (e.g., KnowledgeStorage(...)) ...</h1>
<p>self.sources = sources self.storage.initialize_knowledge_storage() self._add_sources() # Tell sources to load/chunk/embed/save</p>
<p>def query(self, query: List[str], limit: int = 3) -&gt; List[Dict[str, Any]]: if self.storage is None: raise ValueError("Storage not initialized.") </p>
<h1><a class="anchor" id="autotoc_md1586"></a>
Delegate search to the storage object</h1>
<p>return self.storage.search(query, limit)</p>
<p>def _add_sources(self): for source in self.sources: source.storage = self.storage # Give source access to storage source.add() # Source loads, chunks, embeds, and saves ```</p>
<ul>
<li><b><code>crewai/knowledge/source/</code></b>: Contains different <code>KnowledgeSource</code> implementations.<ul>
<li><code>base_knowledge_source.py</code>: Defines the <code>BaseKnowledgeSource</code> abstract class, including the <code>add()</code> method placeholder and helper methods like <code>_chunk_text()</code>.</li>
<li><code>crew_docling_source.py</code>: Implements loading from files and URLs using the <code>docling</code> library. Its <code>add()</code> method loads content, chunks it, and calls <code>self._save_documents()</code>.</li>
<li><code>_save_documents()</code> (in <code>base_knowledge_source.py</code> or subclasses) typically calls <code>self.storage.save(self.chunks)</code>.</li>
</ul>
</li>
<li><b><code>crewai/knowledge/storage/knowledge_storage.py</code></b>:<ul>
<li>The <code>KnowledgeStorage</code> class acts as a wrapper around the actual vector database (ChromaDB by default).</li>
<li><code>initialize_knowledge_storage()</code>: Sets up the connection to ChromaDB and gets/creates the specified collection.</li>
<li><code>save()</code>: Takes the text chunks, gets their embeddings using the configured <code>embedder</code>, and <code>upsert</code>s them into the ChromaDB collection.</li>
<li><code>search()</code>: Takes a query, gets its embedding, and uses the ChromaDB collection's <code>query()</code> method to find and return similar documents.</li>
</ul>
</li>
<li><p class="startli"><b><code>crewai/agent.py</code></b>:</p><ul>
<li>The <code>Agent</code> class has an optional <code>knowledge: Knowledge</code> attribute.</li>
<li>In the <code>execute_task</code> method, before calling the LLM, if <code>self.knowledge</code> exists, it calls <code>self.knowledge.query()</code> using the task prompt (or parts of it) as the query.</li>
<li>The results from <code>knowledge.query()</code> are formatted and added to the task prompt as additional context.</li>
</ul>
<p class="startli">```python </p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md1587"></a>
Simplified view from crewai/agent.py</h1>
<p>class Agent(BaseAgent): knowledge: Optional[Knowledge] = Field(default=None, ...) </p>
<h1><a class="anchor" id="autotoc_md1588"></a>
... other fields ...</h1>
<p>def execute_task(self, task: Task, context: Optional[str] = None, ...) -&gt; str: task_prompt = task.prompt() </p>
<h1><a class="anchor" id="autotoc_md1589"></a>
... add memory context if applicable ...</h1>
<h1><a class="anchor" id="autotoc_md1590"></a>
=== KNOWLEDGE RETRIEVAL ===</h1>
<p>if self.knowledge: </p>
<h1><a class="anchor" id="autotoc_md1591"></a>
Query the knowledge base using the task prompt</h1>
<p>agent_knowledge_snippets = self.knowledge.query([task_prompt]) # Or task.description if agent_knowledge_snippets: </p>
<h1><a class="anchor" id="autotoc_md1592"></a>
Format the snippets into context string</h1>
<p>agent_knowledge_context = extract_knowledge_context(agent_knowledge_snippets) if agent_knowledge_context: </p>
<h1><a class="anchor" id="autotoc_md1593"></a>
Add knowledge context to the prompt</h1>
<p>task_prompt += agent_knowledge_context </p>
<h1><a class="anchor" id="autotoc_md1594"></a>
===========================</h1>
<h1><a class="anchor" id="autotoc_md1595"></a>
... add crew knowledge context if applicable ...</h1>
<h1><a class="anchor" id="autotoc_md1596"></a>
... prepare tools, create agent_executor ...</h1>
<h1><a class="anchor" id="autotoc_md1597"></a>
Call the LLM via agent_executor with the augmented task_prompt</h1>
<p>result = self.agent_executor.invoke({"input": task_prompt, ...})["output"] return result ```</p>
<h2><a class="anchor" id="autotoc_md1598"></a>
Conclusion</h2>
<p>You've now learned about <b><code>Knowledge</code></b> in CrewAI! It's the mechanism for providing your agents with access to specific, pre-existing external information sources like documents or websites. By defining <code>KnowledgeSource</code>s, creating a <code>Knowledge</code> object, and assigning it to an <a class="el" href="../../d2/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_202__agent.html">Agent</a> or <a class="el" href="../../d4/d90/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_201__crew.html">Crew</a>, you enable your agents to retrieve relevant context from these sources using vector search. This makes their responses more accurate, grounded, and aligned with the specific information you provide, distinct from the general interaction history managed by <a class="el" href="../../db/de6/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_207__memory.html">Memory</a>.</p>
<p>This concludes our introductory tour of the core concepts in CrewAI! You've learned about managing the team (<a class="el" href="../../d4/d90/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_201__crew.html">Crew</a>), defining specialized workers (<a class="el" href="../../d2/d55/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_202__agent.html">Agent</a>), assigning work (<a class="el" href="../../d1/dae/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_203__task.html">Task</a>), equipping agents with abilities (<a class="el" href="../../d0/dbf/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_204__tool.html">Tool</a>), setting the workflow (<a class="el" href="../../de/d7d/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_205__process.html">Process</a>), powering the agent's thinking (<a class="el" href="../../da/d0f/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_206__llm.html">LLM</a>), giving them recall (<a class="el" href="../../db/de6/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_207__memory.html">Memory</a>), and providing external information (<a class="el" href="../../dd/d7a/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2CrewAI_208__knowledge.html">Knowledge</a>).</p>
<p>With these building blocks, you're ready to start creating sophisticated AI crews to tackle complex challenges! Happy building!</p>
<hr  />
<p>Generated by <a href="https://github.com/The-Pocket/Tutorial-Codebase-Knowledge">AI Codebase Knowledge Builder</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
