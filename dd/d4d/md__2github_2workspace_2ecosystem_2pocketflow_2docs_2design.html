#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ResilientDB: design</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dd/d4d/md__2github_2workspace_2ecosystem_2pocketflow_2docs_2design.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">design</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md1603"></a>
autotoc_md1603</h2>
<p>layout: default title: "System Design" </p>
<h2><a class="anchor" id="autotoc_md1604"></a>
nav_order: 2</h2>
<h1><a class="anchor" id="autotoc_md1605"></a>
System Design: Codebase Knowledge Builder</h1>
<blockquote class="doxtable">
<p>Please DON'T remove notes for AI </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md1606"></a>
Requirements</h2>
<blockquote class="doxtable">
<p>Notes for AI: Keep it simple and clear. If the requirements are abstract, write concrete user stories </p>
</blockquote>
<p><b>User Story:</b> As a developer onboarding to a new codebase, I want a tutorial automatically generated from its GitHub repository or local directory, optionally in a specific language. This tutorial should explain the core abstractions, their relationships (visualized), and how they work together, using beginner-friendly language, analogies, and multi-line descriptions where needed, so I can understand the project structure and key concepts quickly without manually digging through all the code.</p>
<p><b>Input:</b></p><ul>
<li>A publicly accessible GitHub repository URL or a local directory path.</li>
<li>A project name (optional, will be derived from the URL/directory if not provided).</li>
<li>Desired language for the tutorial (optional, defaults to English).</li>
</ul>
<p><b>Output:</b></p><ul>
<li>A directory named after the project containing:<ul>
<li>An <code>index.md</code> file with:<ul>
<li>A high-level project summary (potentially translated).</li>
<li>A Mermaid flowchart diagram visualizing relationships between abstractions (using potentially translated names/labels).</li>
<li>An ordered list of links to chapter files (using potentially translated names).</li>
</ul>
</li>
<li>Individual Markdown files for each chapter (<code>01_chapter_one.md</code>, <code>02_chapter_two.md</code>, etc.) detailing core abstractions in a logical order (potentially translated content).</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1607"></a>
Flow Design</h2>
<blockquote class="doxtable">
<p>Notes for AI:</p><ol type="1">
<li>Consider the design patterns of agent, map-reduce, rag, and workflow. Apply them if they fit.</li>
<li>Present a concise, high-level description of the workflow. </li>
</ol>
</blockquote>
<h3><a class="anchor" id="autotoc_md1608"></a>
Applicable Design Pattern:</h3>
<p>This project primarily uses a <b>Workflow</b> pattern to decompose the tutorial generation process into sequential steps. The chapter writing step utilizes a <b>BatchNode</b> (a form of MapReduce) to process each abstraction individually.</p>
<ol type="1">
<li><b>Workflow:</b> The overall process follows a defined sequence: fetch code -&gt; identify abstractions -&gt; analyze relationships -&gt; determine order -&gt; write chapters -&gt; combine tutorial into files.</li>
<li><b>Batch Processing:</b> The <code>WriteChapters</code> node processes each identified abstraction independently (map) before the final tutorial files are structured (reduce).</li>
</ol>
<h3><a class="anchor" id="autotoc_md1609"></a>
Flow high-level Design:</h3>
<ol type="1">
<li><b><code>FetchRepo</code></b>: Crawls the specified GitHub repository URL or local directory using appropriate utility (<code>crawl_github_files</code> or <code>crawl_local_files</code>), retrieving relevant source code file contents.</li>
<li><b><code>IdentifyAbstractions</code></b>: Analyzes the codebase using an LLM to identify up to 10 core abstractions, generate beginner-friendly descriptions (potentially translated if language != English), and list the <em>indices</em> of files related to each abstraction.</li>
<li><b><code>AnalyzeRelationships</code></b>: Uses an LLM to analyze the identified abstractions (referenced by index) and their related code to generate a high-level project summary and describe the relationships/interactions between these abstractions (summary and labels potentially translated if language != English), specifying <em>source</em> and <em>target</em> abstraction indices and a concise label for each interaction.</li>
<li><b><code>OrderChapters</code></b>: Determines the most logical order (as indices) to present the abstractions in the tutorial, considering input context which might be translated. The output order itself is language-independent.</li>
<li><b><code>WriteChapters</code> (BatchNode)</b>: Iterates through the ordered list of abstraction indices. For each abstraction, it calls an LLM to write a detailed, beginner-friendly chapter (content potentially fully translated if language != English), using the relevant code files (accessed via indices) and summaries of previously generated chapters (potentially translated) as context.</li>
<li><b><code>CombineTutorial</code></b>: Creates an output directory, generates a Mermaid diagram from the relationship data (using potentially translated names/labels), and writes the project summary (potentially translated), relationship diagram, chapter links (using potentially translated names), and individually generated chapter files (potentially translated content) into it. Fixed text like "Chapters", "Source Repository", and the attribution footer remain in English.</li>
</ol>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[FetchRepo] --&gt; B[IdentifyAbstractions];</div>
<div class="line">    B --&gt; C[AnalyzeRelationships];</div>
<div class="line">    C --&gt; D[OrderChapters];</div>
<div class="line">    D --&gt; E[Batch WriteChapters];</div>
<div class="line">    E --&gt; F[CombineTutorial];</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1610"></a>
Utility Functions</h2>
<blockquote class="doxtable">
<p>Notes for AI:</p><ol type="1">
<li>Understand the utility function definition thoroughly by reviewing the doc.</li>
<li>Include only the necessary utility functions, based on nodes in the flow. </li>
</ol>
</blockquote>
<ol type="1">
<li><b><code>crawl_github_files</code></b> (<code><a class="el" href="../../d8/dd7/crawl__github__files_8py.html">utils/crawl_github_files.py</a></code>) - <em>External Dependency: requests, gitpython (optional for SSH)</em><ul>
<li><em>Input</em>: <code>repo_url</code> (str), <code>token</code> (str, optional), <code>max_file_size</code> (int, optional), <code>use_relative_paths</code> (bool, optional), <code>include_patterns</code> (set, optional), <code>exclude_patterns</code> (set, optional)</li>
<li><em>Output</em>: <code>dict</code> containing <code>files</code> (dict[str, str]) and <code>stats</code>.</li>
<li><em>Necessity</em>: Required by <code>FetchRepo</code> to download and read source code from GitHub if a <code>repo_url</code> is provided. Handles API calls or SSH cloning, filtering, and file reading.</li>
</ul>
</li>
<li><b><code>crawl_local_files</code></b> (<code><a class="el" href="../../d4/db5/crawl__local__files_8py.html">utils/crawl_local_files.py</a></code>) - <em>External Dependency: None</em><ul>
<li><em>Input</em>: <code>directory</code> (str), <code>max_file_size</code> (int, optional), <code>use_relative_paths</code> (bool, optional), <code>include_patterns</code> (set, optional), <code>exclude_patterns</code> (set, optional)</li>
<li><em>Output</em>: <code>dict</code> containing <code>files</code> (dict[str, str]).</li>
<li><em>Necessity</em>: Required by <code>FetchRepo</code> to read source code from a local directory if a <code>local_dir</code> path is provided. Handles directory walking, filtering, and file reading.</li>
</ul>
</li>
<li><b><code>call_llm</code></b> (<code><a class="el" href="../../d6/dc2/call__llm_8py.html">utils/call_llm.py</a></code>) - <em>External Dependency: LLM Provider API (e.g., Google GenAI)</em><ul>
<li><em>Input</em>: <code>prompt</code> (str), <code>use_cache</code> (bool, optional)</li>
<li><em>Output</em>: <code>response</code> (str)</li>
<li><em>Necessity</em>: Used by <code>IdentifyAbstractions</code>, <code>AnalyzeRelationships</code>, <code>OrderChapters</code>, and <code>WriteChapters</code> for code analysis and content generation. Needs careful prompt engineering and YAML validation (implicit via <code>yaml.safe_load</code> which raises errors).</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md1611"></a>
Node Design</h2>
<h3><a class="anchor" id="autotoc_md1612"></a>
Shared Store</h3>
<blockquote class="doxtable">
<p>Notes for AI: Try to minimize data redundancy </p>
</blockquote>
<p>The shared Store structure is organized as follows:</p>
<div class="fragment"><div class="line">shared = {</div>
<div class="line">    <span class="comment"># --- Inputs ---</span></div>
<div class="line">    <span class="stringliteral">&quot;repo_url&quot;</span>: <span class="keywordtype">None</span>, <span class="comment"># Provided by the user/main script if using GitHub</span></div>
<div class="line">    <span class="stringliteral">&quot;local_dir&quot;</span>: <span class="keywordtype">None</span>, <span class="comment"># Provided by the user/main script if using local directory</span></div>
<div class="line">    <span class="stringliteral">&quot;project_name&quot;</span>: <span class="keywordtype">None</span>, <span class="comment"># Optional, derived from repo_url/local_dir if not provided</span></div>
<div class="line">    <span class="stringliteral">&quot;github_token&quot;</span>: <span class="keywordtype">None</span>, <span class="comment"># Optional, from argument or environment variable</span></div>
<div class="line">    <span class="stringliteral">&quot;output_dir&quot;</span>: <span class="stringliteral">&quot;output&quot;</span>, <span class="comment"># Default or user-specified base directory for output</span></div>
<div class="line">    <span class="stringliteral">&quot;include_patterns&quot;</span>: <a class="code hl_function" href="../../d7/da6/pybind__kv__service_8cpp.html#a26ae8807a2b3217bb2339bd18aaaa4e6">set</a>(), <span class="comment"># File patterns to include</span></div>
<div class="line">    <span class="stringliteral">&quot;exclude_patterns&quot;</span>: <a class="code hl_function" href="../../d7/da6/pybind__kv__service_8cpp.html#a26ae8807a2b3217bb2339bd18aaaa4e6">set</a>(), <span class="comment"># File patterns to exclude</span></div>
<div class="line">    <span class="stringliteral">&quot;max_file_size&quot;</span>: 100000, <span class="comment"># Default or user-specified max file size</span></div>
<div class="line">    <span class="stringliteral">&quot;language&quot;</span>: <span class="stringliteral">&quot;english&quot;</span>, <span class="comment"># Default or user-specified language for the tutorial</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment"># --- Intermediate/Output Data ---</span></div>
<div class="line">    <span class="stringliteral">&quot;files&quot;</span>: [], <span class="comment"># Output of FetchRepo: List of tuples (file_path: str, file_content: str)</span></div>
<div class="line">    <span class="stringliteral">&quot;abstractions&quot;</span>: [], <span class="comment"># Output of IdentifyAbstractions: List of {&quot;name&quot;: str (potentially translated), &quot;description&quot;: str (potentially translated), &quot;files&quot;: [int]} (indices into shared[&quot;files&quot;])</span></div>
<div class="line">    <span class="stringliteral">&quot;relationships&quot;</span>: { <span class="comment"># Output of AnalyzeRelationships</span></div>
<div class="line">         <span class="stringliteral">&quot;summary&quot;</span>: <span class="keywordtype">None</span>, <span class="comment"># Overall project summary (potentially translated)</span></div>
<div class="line">         <span class="stringliteral">&quot;details&quot;</span>: [] <span class="comment"># List of {&quot;from&quot;: int, &quot;to&quot;: int, &quot;label&quot;: str (potentially translated)} describing relationships between abstraction indices.</span></div>
<div class="line">     },</div>
<div class="line">    <span class="stringliteral">&quot;chapter_order&quot;</span>: [], <span class="comment"># Output of OrderChapters: List of indices into shared[&quot;abstractions&quot;], determining tutorial order</span></div>
<div class="line">    <span class="stringliteral">&quot;chapters&quot;</span>: [], <span class="comment"># Output of WriteChapters: List of chapter content strings (Markdown, potentially translated), ordered according to chapter_order</span></div>
<div class="line">    <span class="stringliteral">&quot;final_output_dir&quot;</span>: <span class="keywordtype">None</span> <span class="comment"># Output of CombineTutorial: Path to the final generated tutorial directory (e.g., &quot;output/my_project&quot;)</span></div>
<div class="line">}</div>
<div class="ttc" id="apybind__kv__service_8cpp_html_a26ae8807a2b3217bb2339bd18aaaa4e6"><div class="ttname"><a href="../../d7/da6/pybind__kv__service_8cpp.html#a26ae8807a2b3217bb2339bd18aaaa4e6">set</a></div><div class="ttdeci">bool set(std::string key, std::string value, std::string config_path)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/da6/pybind__kv__service_8cpp_source.html#l00051">pybind_kv_service.cpp:51</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1613"></a>
Node Steps</h3>
<blockquote class="doxtable">
<p>Notes for AI: Carefully decide whether to use Batch/Async Node/Flow. Removed explicit try/except in exec, relying on Node's built-in fault tolerance. </p>
</blockquote>
<ol type="1">
<li><b><code>FetchRepo</code></b><ul>
<li><em>Purpose</em>: Download the repository code (from GitHub) or read from a local directory, loading relevant files into memory using the appropriate crawler utility.</li>
<li><em>Type</em>: Regular</li>
<li><em>Steps</em>:<ul>
<li><code>prep</code>: Read <code>repo_url</code>, <code>local_dir</code>, <code>project_name</code>, <code>github_token</code>, <code>output_dir</code>, <code>include_patterns</code>, <code>exclude_patterns</code>, <code>max_file_size</code> from shared store. Determine <code>project_name</code> from <code>repo_url</code> or <code>local_dir</code> if not present in shared. Set <code>use_relative_paths</code> flag.</li>
<li><code>exec</code>: If <code>repo_url</code> is present, call <code>crawl_github_files(...)</code>. Otherwise, call <code>crawl_local_files(...)</code>. Convert the resulting <code>files</code> dictionary into a list of <code>(path, content)</code> tuples.</li>
<li><code>post</code>: Write the list of <code>files</code> tuples and the derived <code>project_name</code> (if applicable) to the shared store.</li>
</ul>
</li>
</ul>
</li>
<li><b><code>IdentifyAbstractions</code></b><ul>
<li><em>Purpose</em>: Analyze the code to identify key concepts/abstractions using indices. Generates potentially translated names and descriptions if language is not English.</li>
<li><em>Type</em>: Regular</li>
<li><em>Steps</em>:<ul>
<li><code>prep</code>: Read <code>files</code> (list of tuples), <code>project_name</code>, and <code>language</code> from shared store. Create context using <code>create_llm_context</code> helper which adds file indices. Format the list of <code>index # path</code> for the prompt.</li>
<li><code>exec</code>: Construct a prompt for <code>call_llm</code>. If language is not English, add instructions to generate <code>name</code> and <code>description</code> in the target language. Ask LLM to identify ~5-10 core abstractions, provide a simple description for each, and list the relevant <em>file indices</em> (e.g., <code>- 0 # path/to/file.py</code>). Request YAML list output. Parse and validate the YAML, ensuring indices are within bounds and converting entries like <code>0 # path...</code> to just the integer <code>0</code>.</li>
<li><code>post</code>: Write the validated list of <code>abstractions</code> (e.g., <code>[{"name": "Node", "description": "...", "files": [0, 3, 5]}, ...]</code>) containing file <em>indices</em> and potentially translated <code>name</code>/<code>description</code> to the shared store.</li>
</ul>
</li>
</ul>
</li>
<li><b><code>AnalyzeRelationships</code></b><ul>
<li><em>Purpose</em>: Generate a project summary and describe how the identified abstractions interact using indices and concise labels. Generates potentially translated summary and labels if language is not English.</li>
<li><em>Type</em>: Regular</li>
<li><em>Steps</em>:<ul>
<li><code>prep</code>: Read <code>abstractions</code>, <code>files</code>, <code>project_name</code>, and <code>language</code> from shared store. Format context for the LLM, including potentially translated abstraction names <em>and indices</em>, potentially translated descriptions, and content snippets from related files (referenced by <code>index # path</code> using <code>get_content_for_indices</code> helper). Prepare the list of <code>index # AbstractionName</code> (potentially translated) for the prompt.</li>
<li><code>exec</code>: Construct a prompt for <code>call_llm</code>. If language is not English, add instructions to generate <code>summary</code> and <code>label</code> in the target language, and note that input names might be translated. Ask for (1) a high-level summary and (2) a list of relationships, each specifying <code>from_abstraction</code> (e.g., <code>0 # Abstraction1</code>), <code>to_abstraction</code> (e.g., <code>1 # Abstraction2</code>), and a concise <code>label</code>. Request structured YAML output. Parse and validate, converting referenced abstractions to indices (<code>from: 0, to: 1</code>).</li>
<li><code>post</code>: Parse the LLM response and write the <code>relationships</code> dictionary (<code>{"summary": "...", "details": [{"from": 0, "to": 1, "label": "..."}, ...]}</code>) with indices and potentially translated <code>summary</code>/<code>label</code> to the shared store.</li>
</ul>
</li>
</ul>
</li>
<li><b><code>OrderChapters</code></b><ul>
<li><em>Purpose</em>: Determine the sequence (as indices) in which abstractions should be presented. Considers potentially translated input context.</li>
<li><em>Type</em>: Regular</li>
<li><em>Steps</em>:<ul>
<li><code>prep</code>: Read <code>abstractions</code>, <code>relationships</code>, <code>project_name</code>, and <code>language</code> from the shared store. Prepare context including the list of <code>index # AbstractionName</code> (potentially translated) and textual descriptions of relationships referencing indices and using the potentially translated <code>label</code>. Note in context if summary/names might be translated.</li>
<li><code>exec</code>: Construct a prompt for <code>call_llm</code> asking it to order the abstractions based on importance, foundational concepts, or dependencies. Request output as an ordered YAML list of <code>index # AbstractionName</code>. Parse and validate, extracting only the indices and ensuring all are present exactly once.</li>
<li><code>post</code>: Write the validated ordered list of indices (<code>chapter_order</code>) to the shared store.</li>
</ul>
</li>
</ul>
</li>
<li><b><code>WriteChapters</code></b><ul>
<li><em>Purpose</em>: Generate the detailed content for each chapter of the tutorial. Generates potentially fully translated chapter content if language is not English.</li>
<li><em>Type</em>: <b>BatchNode</b></li>
<li><em>Steps</em>:<ul>
<li><code>prep</code>: Read <code>chapter_order</code> (indices), <code>abstractions</code>, <code>files</code>, <code>project_name</code>, and <code>language</code> from shared store. Initialize an empty instance variable <code>self.chapters_written_so_far</code>. Return an iterable list where each item corresponds to an <em>abstraction index</em> from <code>chapter_order</code>. Each item should contain chapter number, potentially translated abstraction details, a map of related file content (<code>{ "idx # path": content }</code>), full chapter listing (potentially translated names), chapter filename map, previous/next chapter info (potentially translated names), and language.</li>
<li><code>exec(item)</code>: Construct a prompt for <code>call_llm</code>. If language is not English, add detailed instructions to write the <em>entire</em> chapter in the target language, translating explanations, examples, etc., while noting which input context might already be translated. Ask LLM to write a beginner-friendly Markdown chapter. Provide potentially translated concept details. Include a summary of previously written chapters (potentially translated). Provide relevant code snippets. Add the generated (potentially translated) chapter content to <code>self.chapters_written_so_far</code> for the next iteration's context. Return the chapter content.</li>
<li><code>post(shared, prep_res, exec_res_list)</code>: <code>exec_res_list</code> contains the generated chapter Markdown content strings (potentially translated), ordered correctly. Assign this list directly to <code>shared["chapters"]</code>. Clean up <code>self.chapters_written_so_far</code>.</li>
</ul>
</li>
</ul>
</li>
<li><b><code>CombineTutorial</code></b><ul>
<li><em>Purpose</em>: Assemble the final tutorial files, including a Mermaid diagram using potentially translated labels/names. Fixed text remains English.</li>
<li><em>Type</em>: Regular</li>
<li><em>Steps</em>:<ul>
<li><code>prep</code>: Read <code>project_name</code>, <code>relationships</code> (potentially translated summary/labels), <code>chapter_order</code> (indices), <code>abstractions</code> (potentially translated name/desc), <code>chapters</code> (list of potentially translated content), <code>repo_url</code>, and <code>output_dir</code> from shared store. Generate a Mermaid <code>flowchart TD</code> string based on <code>relationships["details"]</code>, using indices to identify nodes (potentially translated names) and the concise <code>label</code> (potentially translated) for edges. Construct the content for <code>index.md</code> (including potentially translated summary, Mermaid diagram, and ordered links to chapters using potentially translated names derived using <code>chapter_order</code> and <code>abstractions</code>). Define the output directory path (e.g., <code>./output_dir/project_name</code>). Prepare a list of <code>{ "filename": "01_...", "content": "..." }</code> for chapters, adding the English attribution footer to each chapter's content. Add the English attribution footer to the index content.</li>
<li><code>exec</code>: Create the output directory. Write the generated <code>index.md</code> content. Iterate through the prepared chapter file list and write each chapter's content to its corresponding <code>.md</code> file in the output directory.</li>
<li><code>post</code>: Write the final <code>output_path</code> to <code>shared["final_output_dir"]</code>. Log completion. </li>
</ul>
</li>
</ul>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
